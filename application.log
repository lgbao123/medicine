13-10-2023 12:57:38 : root : INFO : Created spark <pyspark.sql.session.SparkSession object at 0x7f96da92f080>
13-10-2023 02:13:59 : root : INFO : Calling spark object
13-10-2023 02:13:59 : create_spark : INFO : start get_spark_object method
13-10-2023 02:13:59 : create_spark : INFO : master is local[*]
13-10-2023 02:14:03 : root : INFO : Validate spark object
13-10-2023 02:14:03 : validate : WARNING : Start get_current_date method
13-10-2023 02:14:07 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 02:14:07 : validate : WARNING : Validation done ...
13-10-2023 02:14:07 : root : INFO : Application done
13-10-2023 02:16:21 : root : INFO : Calling spark object
13-10-2023 02:16:21 : create_spark : INFO : start get_spark_object method
13-10-2023 02:16:21 : create_spark : INFO : master is local[*]
13-10-2023 02:16:26 : create_spark : INFO : Spark obect created :{spark}
13-10-2023 02:16:26 : root : INFO : Validate spark object
13-10-2023 02:16:26 : validate : WARNING : Start get_current_date method
13-10-2023 02:16:30 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 02:16:30 : validate : WARNING : Validation done ...
13-10-2023 02:16:30 : root : INFO : Application done
13-10-2023 02:18:23 : root : INFO : Calling spark object
13-10-2023 02:18:23 : create_spark : INFO : start get_spark_object method
13-10-2023 02:18:23 : create_spark : INFO : master is local[*]
13-10-2023 02:18:28 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe5bde8bba8>...
13-10-2023 02:18:28 : root : INFO : Validate spark object
13-10-2023 02:18:28 : validate : WARNING : Start get_current_date method
13-10-2023 02:18:32 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 02:18:32 : validate : WARNING : Validation done ...
13-10-2023 02:18:32 : root : INFO : Application done
13-10-2023 02:19:23 : root : INFO : Calling spark object
13-10-2023 02:19:23 : create_spark : INFO : start get_spark_object method
13-10-2023 02:19:23 : create_spark : INFO : master is local[*]
13-10-2023 02:19:29 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f21d5617710>...
13-10-2023 02:19:29 : root : INFO : Validate spark object
13-10-2023 02:19:29 : validate : WARNING : Start get_current_date method
13-10-2023 02:19:33 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 02:19:33 : validate : WARNING : Validation done ...
13-10-2023 02:19:33 : root : INFO : --------------Application done----------------
13-10-2023 02:19:41 : root : INFO : Calling spark object
13-10-2023 02:19:41 : create_spark : INFO : start get_spark_object method
13-10-2023 02:19:41 : create_spark : INFO : master is local[*]
13-10-2023 02:19:46 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f8dbf2836a0>...
13-10-2023 02:19:46 : root : INFO : Validate spark object
13-10-2023 02:19:46 : validate : WARNING : Start get_current_date method
13-10-2023 02:19:49 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 02:19:49 : validate : WARNING : Validation done ...
13-10-2023 02:19:49 : root : INFO : --------------Application done----------------
13-10-2023 10:44:18 : root : INFO : Calling spark object
13-10-2023 10:44:18 : create_spark : INFO : start get_spark_object method
13-10-2023 10:44:18 : create_spark : INFO : master is local[*]
13-10-2023 10:44:24 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe78caf84e0>...
13-10-2023 10:44:24 : root : INFO : Validate spark object
13-10-2023 10:44:24 : validate : WARNING : Start get_current_date method
13-10-2023 10:44:28 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:44:28 : validate : WARNING : Validation done ...
13-10-2023 10:44:28 : root : INFO : --------------Application done----------------
13-10-2023 10:45:58 : root : INFO : Calling spark object
13-10-2023 10:45:58 : create_spark : INFO : start get_spark_object method
13-10-2023 10:45:58 : create_spark : INFO : master is local[*]
13-10-2023 10:46:03 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fad77f47550>...
13-10-2023 10:46:03 : root : INFO : Validate spark object
13-10-2023 10:46:03 : validate : WARNING : Start get_current_date method
13-10-2023 10:46:06 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:46:06 : validate : WARNING : Validation done ...
13-10-2023 10:46:06 : root : INFO : Load file 
13-10-2023 10:46:06 : ingest : WARNING : Start load file method.
13-10-2023 10:46:06 : ingest : ERROR : An error in occurs in load_file(): An error occurred while calling o33.load.
: java.io.IOException: Illegal file pattern: error parsing regexp: invalid escape sequence: `\u`
	at org.apache.hadoop.fs.GlobFilter.init(GlobFilter.java:71)
	at org.apache.hadoop.fs.GlobFilter.<init>(GlobFilter.java:50)
	at org.apache.hadoop.fs.Globber.doGlob(Globber.java:265)
	at org.apache.hadoop.fs.Globber.glob(Globber.java:202)
	at org.apache.hadoop.fs.FileSystem.globStatus(FileSystem.java:2124)
	at org.apache.spark.deploy.SparkHadoopUtil.globPath(SparkHadoopUtil.scala:254)
	at org.apache.spark.sql.execution.datasources.DataSource$.$anonfun$checkAndGlobPathIfNecessary$3(DataSource.scala:737)
	at org.apache.spark.util.ThreadUtils$.$anonfun$parmap$2(ThreadUtils.scala:393)
	at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)
	at scala.util.Success.$anonfun$map$1(Try.scala:255)
	at scala.util.Success.map(Try.scala:213)
	at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1426)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1603)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:177)
Caused by: org.apache.hadoop.shaded.com.google.re2j.PatternSyntaxException: error parsing regexp: invalid escape sequence: `\u`
	at org.apache.hadoop.shaded.com.google.re2j.Parser.parseEscape(Parser.java:1439)
	at org.apache.hadoop.shaded.com.google.re2j.Parser.parseInternal(Parser.java:966)
	at org.apache.hadoop.shaded.com.google.re2j.Parser.parse(Parser.java:802)
	at org.apache.hadoop.shaded.com.google.re2j.RE2.compileImpl(RE2.java:183)
	at org.apache.hadoop.shaded.com.google.re2j.Pattern.compile(Pattern.java:136)
	at org.apache.hadoop.shaded.com.google.re2j.Pattern.compile(Pattern.java:124)
	at org.apache.hadoop.fs.GlobPattern.set(GlobPattern.java:156)
	at org.apache.hadoop.fs.GlobPattern.<init>(GlobPattern.java:42)
	at org.apache.hadoop.fs.GlobFilter.init(GlobFilter.java:67)
	... 18 more

13-10-2023 10:46:06 : root : ERROR : An error in main() : local variable 'df' referenced before assignment
13-10-2023 10:46:06 : root : INFO : --------------Application done----------------
13-10-2023 10:47:19 : root : INFO : Calling spark object
13-10-2023 10:47:19 : create_spark : INFO : start get_spark_object method
13-10-2023 10:47:19 : create_spark : INFO : master is local[*]
13-10-2023 10:47:24 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f435ce034e0>...
13-10-2023 10:47:24 : root : INFO : Validate spark object
13-10-2023 10:47:24 : validate : WARNING : Start get_current_date method
13-10-2023 10:47:28 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:47:28 : validate : WARNING : Validation done ...
13-10-2023 10:47:28 : root : INFO : Load file 
13-10-2023 10:47:28 : ingest : WARNING : Start load file method.
13-10-2023 10:47:28 : ingest : ERROR : An error in occurs in load_file(): An error occurred while calling o33.load.
: java.io.IOException: Illegal file pattern: error parsing regexp: invalid escape sequence: `\u`
	at org.apache.hadoop.fs.GlobFilter.init(GlobFilter.java:71)
	at org.apache.hadoop.fs.GlobFilter.<init>(GlobFilter.java:50)
	at org.apache.hadoop.fs.Globber.doGlob(Globber.java:265)
	at org.apache.hadoop.fs.Globber.glob(Globber.java:202)
	at org.apache.hadoop.fs.FileSystem.globStatus(FileSystem.java:2124)
	at org.apache.spark.deploy.SparkHadoopUtil.globPath(SparkHadoopUtil.scala:254)
	at org.apache.spark.sql.execution.datasources.DataSource$.$anonfun$checkAndGlobPathIfNecessary$3(DataSource.scala:737)
	at org.apache.spark.util.ThreadUtils$.$anonfun$parmap$2(ThreadUtils.scala:393)
	at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)
	at scala.util.Success.$anonfun$map$1(Try.scala:255)
	at scala.util.Success.map(Try.scala:213)
	at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1426)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1603)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:177)
Caused by: org.apache.hadoop.shaded.com.google.re2j.PatternSyntaxException: error parsing regexp: invalid escape sequence: `\u`
	at org.apache.hadoop.shaded.com.google.re2j.Parser.parseEscape(Parser.java:1439)
	at org.apache.hadoop.shaded.com.google.re2j.Parser.parseInternal(Parser.java:966)
	at org.apache.hadoop.shaded.com.google.re2j.Parser.parse(Parser.java:802)
	at org.apache.hadoop.shaded.com.google.re2j.RE2.compileImpl(RE2.java:183)
	at org.apache.hadoop.shaded.com.google.re2j.Pattern.compile(Pattern.java:136)
	at org.apache.hadoop.shaded.com.google.re2j.Pattern.compile(Pattern.java:124)
	at org.apache.hadoop.fs.GlobPattern.set(GlobPattern.java:156)
	at org.apache.hadoop.fs.GlobPattern.<init>(GlobPattern.java:42)
	at org.apache.hadoop.fs.GlobFilter.init(GlobFilter.java:67)
	... 18 more

13-10-2023 10:47:28 : root : ERROR : An error in main() : local variable 'df' referenced before assignment
13-10-2023 10:47:28 : root : INFO : --------------Application done----------------
13-10-2023 10:50:10 : root : INFO : Calling spark object
13-10-2023 10:50:10 : create_spark : INFO : start get_spark_object method
13-10-2023 10:50:10 : create_spark : INFO : master is local[*]
13-10-2023 10:50:15 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f61c4d034e0>...
13-10-2023 10:50:15 : root : INFO : Validate spark object
13-10-2023 10:50:15 : validate : WARNING : Start get_current_date method
13-10-2023 10:50:19 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:50:19 : validate : WARNING : Validation done ...
13-10-2023 10:50:19 : root : INFO : Load file 
13-10-2023 10:50:19 : ingest : WARNING : Start load file method.
13-10-2023 10:50:19 : root : ERROR : An error in main() : local variable 'df' referenced before assignment
13-10-2023 10:50:19 : root : INFO : --------------Application done----------------
13-10-2023 10:51:18 : root : INFO : Calling spark object
13-10-2023 10:51:18 : create_spark : INFO : start get_spark_object method
13-10-2023 10:51:18 : create_spark : INFO : master is local[*]
13-10-2023 10:51:23 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fb68f3ca5c0>...
13-10-2023 10:51:23 : root : INFO : Validate spark object
13-10-2023 10:51:23 : validate : WARNING : Start get_current_date method
13-10-2023 10:51:27 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:51:27 : validate : WARNING : Validation done ...
13-10-2023 10:51:27 : root : INFO : Load file 
13-10-2023 10:51:27 : ingest : WARNING : Start load file method.
13-10-2023 10:51:28 : ingest : WARNING : Load file done which is of parquet..........
13-10-2023 10:51:28 : ingest : WARNING : Start load file method.
13-10-2023 10:51:28 : root : ERROR : An error in main() : option() got an unexpected keyword argument 'header'
13-10-2023 10:51:28 : root : INFO : --------------Application done----------------
13-10-2023 10:52:27 : root : INFO : Calling spark object
13-10-2023 10:52:27 : create_spark : INFO : start get_spark_object method
13-10-2023 10:52:27 : create_spark : INFO : master is local[*]
13-10-2023 10:52:32 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f0611f36470>...
13-10-2023 10:52:32 : root : INFO : Validate spark object
13-10-2023 10:52:32 : validate : WARNING : Start get_current_date method
13-10-2023 10:52:36 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:52:36 : validate : WARNING : Validation done ...
13-10-2023 10:52:36 : root : INFO : Load file 
13-10-2023 10:52:36 : ingest : WARNING : Start load file method.
13-10-2023 10:52:37 : ingest : WARNING : Load file done which is of parquet..........
13-10-2023 10:52:37 : root : INFO : --------------Application done----------------
13-10-2023 10:54:55 : root : INFO : Calling spark object
13-10-2023 10:54:55 : create_spark : INFO : start get_spark_object method
13-10-2023 10:54:55 : create_spark : INFO : master is local[*]
13-10-2023 10:55:00 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f5b26c02550>...
13-10-2023 10:55:00 : root : INFO : Validate spark object
13-10-2023 10:55:00 : validate : WARNING : Start get_current_date method
13-10-2023 10:55:03 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:55:03 : validate : WARNING : Validation done ...
13-10-2023 10:55:03 : root : INFO : Load file 
13-10-2023 10:55:03 : ingest : WARNING : Start load file method.
13-10-2023 10:55:04 : ingest : WARNING : Load file done which is of parquet..........
13-10-2023 10:55:04 : root : INFO : Show df 
13-10-2023 10:55:05 : root : INFO : --------------Application done----------------
13-10-2023 10:57:07 : root : INFO : Calling spark object
13-10-2023 10:57:07 : create_spark : INFO : start get_spark_object method
13-10-2023 10:57:07 : create_spark : INFO : master is local[*]
13-10-2023 10:57:12 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f34cc1f5be0>...
13-10-2023 10:57:12 : root : INFO : Validate spark object
13-10-2023 10:57:12 : validate : WARNING : Start get_current_date method
13-10-2023 10:57:15 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 10:57:15 : validate : WARNING : Validation done ...
13-10-2023 10:57:15 : root : INFO : Load file 
13-10-2023 10:57:15 : ingest : WARNING : Start load file method.
13-10-2023 10:57:15 : root : ERROR : An error in main() : option() got an unexpected keyword argument 'header'
13-10-2023 10:57:15 : root : INFO : --------------Application done----------------
13-10-2023 11:01:30 : root : INFO : Calling spark object
13-10-2023 11:01:30 : create_spark : INFO : start get_spark_object method
13-10-2023 11:01:30 : create_spark : INFO : master is local[*]
13-10-2023 11:01:35 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f0e98d4a550>...
13-10-2023 11:01:35 : root : INFO : Validate spark object
13-10-2023 11:01:35 : validate : WARNING : Start get_current_date method
13-10-2023 11:01:38 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 11:01:38 : validate : WARNING : Validation done ...
13-10-2023 11:01:38 : root : INFO : Load file 
13-10-2023 11:01:38 : ingest : WARNING : Start load file method.
13-10-2023 11:01:43 : ingest : WARNING : Load file done which is of csv..........
13-10-2023 11:01:43 : root : INFO : Show dataframe :
13-10-2023 11:01:43 : root : INFO : --------------Application done----------------
13-10-2023 11:04:08 : root : INFO : Calling spark object
13-10-2023 11:04:08 : create_spark : INFO : start get_spark_object method
13-10-2023 11:04:08 : create_spark : INFO : master is local[*]
13-10-2023 11:04:13 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f47dcf1ebe0>...
13-10-2023 11:04:13 : root : INFO : Validate spark object
13-10-2023 11:04:13 : validate : WARNING : Start get_current_date method
13-10-2023 11:04:16 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 11:04:16 : validate : WARNING : Validation done ...
13-10-2023 11:04:16 : root : INFO : Load file 
13-10-2023 11:04:16 : ingest : WARNING : Start load file method.
13-10-2023 11:04:16 : ingest : ERROR : An error in occurs in load_file(): option() got an unexpected keyword argument 'inferSchema'
13-10-2023 11:04:16 : root : ERROR : An error in main() : option() got an unexpected keyword argument 'inferSchema'
13-10-2023 11:04:16 : root : INFO : --------------Application done----------------
13-10-2023 11:14:13 : root : INFO : Calling spark object
13-10-2023 11:14:13 : create_spark : INFO : start get_spark_object method
13-10-2023 11:14:13 : create_spark : INFO : master is local[*]
13-10-2023 11:14:19 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fbdeb5b35c0>...
13-10-2023 11:14:19 : root : INFO : Validate spark object
13-10-2023 11:14:19 : validate : WARNING : Start get_current_date method
13-10-2023 11:14:22 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 11:14:22 : validate : WARNING : Validation done ...
13-10-2023 11:14:22 : root : INFO : Load file 
13-10-2023 11:14:22 : ingest : WARNING : Start load file method.
13-10-2023 11:14:26 : ingest : WARNING : Load file done which is of csv..........
13-10-2023 11:14:26 : root : INFO : Show dataframe :
13-10-2023 11:14:26 : root : INFO : Validate dataframe :
13-10-2023 11:14:26 : ingest : WARNING : Start validate df method
13-10-2023 11:14:28 : ingest : WARNING : Number record df: 1329329
13-10-2023 11:14:28 : root : INFO : --------------Application done----------------
13-10-2023 11:36:54 : root : INFO : Calling spark object
13-10-2023 11:36:54 : create_spark : INFO : start get_spark_object method
13-10-2023 11:36:54 : create_spark : INFO : master is local[*]
13-10-2023 11:37:05 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fb59c1c8630>...
13-10-2023 11:37:05 : root : INFO : Validate spark object
13-10-2023 11:37:05 : validate : WARNING : Start get_current_date method
13-10-2023 11:37:09 : validate : WARNING : Validate spark object with current date :2023-10-13
13-10-2023 11:37:09 : validate : WARNING : Validation done ...
13-10-2023 11:37:09 : root : INFO : Load file 
13-10-2023 11:37:09 : ingest : WARNING : Start load file method.
13-10-2023 11:37:16 : ingest : WARNING : Load file done which is of csv..........
13-10-2023 11:37:16 : root : INFO : Show dataframe :
13-10-2023 11:37:17 : root : INFO : Validate dataframe
13-10-2023 11:37:17 : ingest : WARNING : Start validate df method
13-10-2023 11:37:18 : ingest : WARNING : Number record df: 1329329
13-10-2023 11:37:18 : root : INFO : --------------Application done----------------
14-10-2023 12:21:20 : root : INFO : Calling spark object
14-10-2023 12:21:20 : create_spark : INFO : start get_spark_object method
14-10-2023 12:21:20 : create_spark : INFO : master is local[*]
14-10-2023 12:21:25 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fb74e4b93c8>...
14-10-2023 12:21:25 : root : INFO : Validate spark object
14-10-2023 12:21:25 : validate : WARNING : Start get_current_date method
14-10-2023 12:21:29 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:21:29 : validate : WARNING : Validation done ...
14-10-2023 12:21:29 : root : INFO : Load file 
14-10-2023 12:21:29 : ingest : WARNING : Start load file method.
14-10-2023 12:21:34 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:21:34 : root : INFO : Validate dataframe
14-10-2023 12:21:34 : ingest : WARNING : Start validate df method
14-10-2023 12:21:35 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:21:35 : root : INFO : Processing dataframe
14-10-2023 12:21:35 : data_processing : WARNING : Start clean data method ==
14-10-2023 12:21:35 : data_processing : WARNING : Clean data done.......
14-10-2023 12:21:35 : root : INFO : Show dataframe :
14-10-2023 12:21:35 : root : INFO : --------------Application done----------------
14-10-2023 12:44:59 : root : INFO : Calling spark object
14-10-2023 12:44:59 : create_spark : INFO : start get_spark_object method
14-10-2023 12:44:59 : create_spark : INFO : master is local[*]
14-10-2023 12:45:05 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe93117ca90>...
14-10-2023 12:45:05 : root : INFO : Validate spark object
14-10-2023 12:45:05 : validate : WARNING : Start get_current_date method
14-10-2023 12:45:09 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:45:09 : validate : WARNING : Validation done ...
14-10-2023 12:45:09 : root : INFO : Load file 
14-10-2023 12:45:09 : ingest : WARNING : Start load file method.
14-10-2023 12:45:14 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:45:14 : root : INFO : Validate dataframe
14-10-2023 12:45:14 : ingest : WARNING : Start validate df method
14-10-2023 12:45:15 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:45:15 : root : INFO : Processing dataframe
14-10-2023 12:45:15 : data_processing : WARNING : Start clean data method ==
14-10-2023 12:45:15 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 12:45:15 : data_processing : WARNING : Create a column
14-10-2023 12:45:15 : data_processing : WARNING : Clean data done.......
14-10-2023 12:45:15 : root : INFO : Show dataframe :
14-10-2023 12:45:16 : validate : WARNING : Start print_data_schema method (Presc_df)
14-10-2023 12:45:16 : validate : ERROR : An error occurs in print_data_schema() : local variable 'fields' referenced before assignment
14-10-2023 12:45:16 : root : ERROR : An error in main() : local variable 'fields' referenced before assignment
14-10-2023 12:45:16 : root : INFO : --------------Application done----------------
14-10-2023 12:45:49 : root : INFO : Calling spark object
14-10-2023 12:45:49 : create_spark : INFO : start get_spark_object method
14-10-2023 12:45:49 : create_spark : INFO : master is local[*]
14-10-2023 12:45:54 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f580d2d5400>...
14-10-2023 12:45:54 : root : INFO : Validate spark object
14-10-2023 12:45:54 : validate : WARNING : Start get_current_date method
14-10-2023 12:45:58 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:45:58 : validate : WARNING : Validation done ...
14-10-2023 12:45:58 : root : INFO : Load file 
14-10-2023 12:45:58 : ingest : WARNING : Start load file method.
14-10-2023 12:46:02 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:46:02 : root : INFO : Validate dataframe
14-10-2023 12:46:02 : ingest : WARNING : Start validate df method
14-10-2023 12:46:03 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:46:03 : root : INFO : Processing dataframe
14-10-2023 12:46:03 : data_processing : WARNING : Start clean data method ==
14-10-2023 12:46:03 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 12:46:03 : data_processing : WARNING : Create a column
14-10-2023 12:46:03 : data_processing : WARNING : Clean data done.......
14-10-2023 12:46:03 : root : INFO : Show dataframe :
14-10-2023 12:46:04 : validate : WARNING : Start print_data_schema method (Presc_df)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(presc_id,IntegerType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(last_name,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(first_name,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(city,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(state,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(desc,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(drug_name,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(total_claim_count,IntegerType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(total_day_supply,IntegerType,true)
14-10-2023 12:46:04 : validate : WARNING : 	StructField(years_of_exp,StringType,true)
14-10-2023 12:46:04 : validate : WARNING : print_data_schema done ...
14-10-2023 12:46:04 : root : INFO : --------------Application done----------------
14-10-2023 12:46:45 : root : INFO : Calling spark object
14-10-2023 12:46:45 : create_spark : INFO : start get_spark_object method
14-10-2023 12:46:45 : create_spark : INFO : master is local[*]
14-10-2023 12:46:50 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7ffa28af7400>...
14-10-2023 12:46:50 : root : INFO : Validate spark object
14-10-2023 12:46:50 : validate : WARNING : Start get_current_date method
14-10-2023 12:46:53 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:46:53 : validate : WARNING : Validation done ...
14-10-2023 12:46:53 : root : INFO : Load file 
14-10-2023 12:46:53 : ingest : WARNING : Start load file method.
14-10-2023 12:46:57 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:46:57 : root : INFO : Validate dataframe
14-10-2023 12:46:57 : ingest : WARNING : Start validate df method
14-10-2023 12:46:58 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:46:58 : root : INFO : Processing dataframe
14-10-2023 12:46:58 : data_processing : WARNING : Start clean data method ==
14-10-2023 12:46:58 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 12:46:59 : data_processing : WARNING : Create a column
14-10-2023 12:46:59 : data_processing : WARNING : Clean data done.......
14-10-2023 12:46:59 : root : INFO : Show dataframe :
14-10-2023 12:46:59 : validate : WARNING : Start print_data_schema method (Presc_df)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(presc_id,IntegerType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(last_name,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(first_name,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(city,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(state,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(desc,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(drug_name,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(total_claim_count,IntegerType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(total_day_supply,IntegerType,true)
14-10-2023 12:46:59 : validate : WARNING : 			StructField(years_of_exp,StringType,true)
14-10-2023 12:46:59 : validate : WARNING : print_data_schema done ...
14-10-2023 12:46:59 : root : INFO : --------------Application done----------------
14-10-2023 12:56:56 : root : INFO : Calling spark object
14-10-2023 12:56:56 : create_spark : INFO : start get_spark_object method
14-10-2023 12:56:56 : create_spark : INFO : master is local[*]
14-10-2023 12:57:01 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f7595a034e0>...
14-10-2023 12:57:01 : root : INFO : Validate spark object
14-10-2023 12:57:01 : validate : WARNING : Start get_current_date method=====
14-10-2023 12:57:04 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:57:04 : validate : WARNING : Validation done ...
14-10-2023 12:57:04 : root : INFO : Load file 
14-10-2023 12:57:04 : ingest : WARNING : Start load file method ======
14-10-2023 12:57:08 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:57:08 : root : INFO : Validate dataframe
14-10-2023 12:57:08 : ingest : WARNING : Start validate df method =====
14-10-2023 12:57:10 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:57:10 : root : INFO : Processing dataframe
14-10-2023 12:57:10 : data_processing : WARNING : Start clean data method ====
14-10-2023 12:57:10 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 12:57:10 : data_processing : WARNING : Create a new column
14-10-2023 12:57:10 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 12:57:10 : data_processing : WARNING : Clean data done.......
14-10-2023 12:57:10 : root : INFO : Show dataframe :
14-10-2023 12:57:10 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(last_name,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(first_name,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 12:57:10 : validate : WARNING : 		StructField(years_of_exp,StringType,true)
14-10-2023 12:57:10 : validate : WARNING : print_data_schema done ...
14-10-2023 12:57:10 : root : INFO : --------------Application done----------------
14-10-2023 12:58:31 : root : INFO : Calling spark object
14-10-2023 12:58:31 : create_spark : INFO : start get_spark_object method
14-10-2023 12:58:31 : create_spark : INFO : master is local[*]
14-10-2023 12:58:36 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe53f99d470>...
14-10-2023 12:58:36 : root : INFO : Validate spark object
14-10-2023 12:58:36 : validate : WARNING : Start get_current_date method=====
14-10-2023 12:58:40 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:58:40 : validate : WARNING : Validation done ...
14-10-2023 12:58:40 : root : INFO : Load file 
14-10-2023 12:58:40 : ingest : WARNING : Start load file method ======
14-10-2023 12:58:44 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:58:44 : root : INFO : Validate dataframe
14-10-2023 12:58:44 : ingest : WARNING : Start validate df method =====
14-10-2023 12:58:45 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:58:45 : root : INFO : Processing dataframe
14-10-2023 12:58:45 : data_processing : WARNING : Start clean data method ====
14-10-2023 12:58:45 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 12:58:45 : data_processing : WARNING : Create a new column
14-10-2023 12:58:45 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 12:58:45 : data_processing : WARNING : Clean data done.......
14-10-2023 12:58:45 : root : INFO : Show dataframe :
14-10-2023 12:58:45 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(last_name,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(first_name,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 12:58:45 : validate : WARNING : 		StructField(years_of_exp,StringType,true)
14-10-2023 12:58:45 : validate : WARNING : print_data_schema done ...
14-10-2023 12:58:45 : root : INFO : --------------Application done----------------
14-10-2023 12:59:30 : root : INFO : Calling spark object
14-10-2023 12:59:30 : create_spark : INFO : start get_spark_object method
14-10-2023 12:59:30 : create_spark : INFO : master is local[*]
14-10-2023 12:59:35 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fa91e9e14a8>...
14-10-2023 12:59:35 : root : INFO : Validate spark object
14-10-2023 12:59:35 : validate : WARNING : Start get_current_date method=====
14-10-2023 12:59:38 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 12:59:38 : validate : WARNING : Validation done ...
14-10-2023 12:59:38 : root : INFO : Load file 
14-10-2023 12:59:38 : ingest : WARNING : Start load file method ======
14-10-2023 12:59:42 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 12:59:42 : root : INFO : Validate dataframe
14-10-2023 12:59:42 : ingest : WARNING : Start validate df method =====
14-10-2023 12:59:44 : ingest : WARNING : Number record df: 1329329
14-10-2023 12:59:44 : root : INFO : Processing dataframe
14-10-2023 12:59:44 : data_processing : WARNING : Start clean data method ====
14-10-2023 12:59:44 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 12:59:44 : data_processing : WARNING : Create a new column
14-10-2023 12:59:44 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 12:59:44 : data_processing : WARNING : Clean data done.......
14-10-2023 12:59:44 : root : INFO : Show dataframe :
14-10-2023 12:59:44 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(last_name,StringType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(first_name,StringType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 12:59:44 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 12:59:44 : validate : WARNING : print_data_schema done ...
14-10-2023 12:59:44 : root : INFO : --------------Application done----------------
14-10-2023 01:20:39 : root : INFO : Calling spark object
14-10-2023 01:20:39 : create_spark : INFO : start get_spark_object method
14-10-2023 01:20:39 : create_spark : INFO : master is local[*]
14-10-2023 01:20:44 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f7545431400>...
14-10-2023 01:20:44 : root : INFO : Validate spark object
14-10-2023 01:20:44 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:20:47 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:20:47 : validate : WARNING : Validation done ...
14-10-2023 01:20:47 : root : INFO : Load file 
14-10-2023 01:20:47 : ingest : WARNING : Start load file method ======
14-10-2023 01:20:51 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:20:51 : root : INFO : Validate dataframe
14-10-2023 01:20:51 : ingest : WARNING : Start validate df method =====
14-10-2023 01:20:52 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:20:52 : root : INFO : Processing dataframe
14-10-2023 01:20:52 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:20:52 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:20:52 : data_processing : WARNING : Create a new column
14-10-2023 01:20:52 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:20:52 : data_processing : WARNING : Create full name column with concating columns
14-10-2023 01:20:53 : data_processing : WARNING : Clean data done.......
14-10-2023 01:20:53 : root : INFO : Show dataframe :
14-10-2023 01:20:53 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(last_name,StringType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(first_name,StringType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 01:20:53 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 01:20:53 : validate : WARNING : print_data_schema done ...
14-10-2023 01:20:53 : root : INFO : --------------Application done----------------
14-10-2023 01:22:45 : root : INFO : Calling spark object
14-10-2023 01:22:45 : create_spark : INFO : start get_spark_object method
14-10-2023 01:22:45 : create_spark : INFO : master is local[*]
14-10-2023 01:22:50 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f689c521b00>...
14-10-2023 01:22:50 : root : INFO : Validate spark object
14-10-2023 01:22:50 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:22:54 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:22:54 : validate : WARNING : Validation done ...
14-10-2023 01:22:54 : root : INFO : Load file 
14-10-2023 01:22:54 : ingest : WARNING : Start load file method ======
14-10-2023 01:22:59 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:22:59 : root : INFO : Validate dataframe
14-10-2023 01:22:59 : ingest : WARNING : Start validate df method =====
14-10-2023 01:23:00 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:23:00 : root : INFO : Processing dataframe
14-10-2023 01:23:00 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:23:00 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:23:01 : data_processing : WARNING : Create a new column
14-10-2023 01:23:01 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:23:01 : data_processing : WARNING : Create full name column with concating columns
14-10-2023 01:23:01 : data_processing : WARNING : Clean data done.......
14-10-2023 01:23:01 : root : INFO : Show dataframe :
14-10-2023 01:23:01 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(last_name,StringType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(first_name,StringType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 01:23:01 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 01:23:01 : validate : WARNING : print_data_schema done ...
14-10-2023 01:23:01 : root : INFO : --------------Application done----------------
14-10-2023 01:27:43 : root : INFO : Calling spark object
14-10-2023 01:27:43 : create_spark : INFO : start get_spark_object method
14-10-2023 01:27:43 : create_spark : INFO : master is local[*]
14-10-2023 01:27:48 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f3b8f195470>...
14-10-2023 01:27:48 : root : INFO : Validate spark object
14-10-2023 01:27:48 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:27:52 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:27:52 : validate : WARNING : Validation done ...
14-10-2023 01:27:52 : root : INFO : Load file 
14-10-2023 01:27:52 : ingest : WARNING : Start load file method ======
14-10-2023 01:27:56 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:27:56 : root : INFO : Validate dataframe
14-10-2023 01:27:56 : ingest : WARNING : Start validate df method =====
14-10-2023 01:27:57 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:27:57 : root : INFO : Processing dataframe
14-10-2023 01:27:57 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:27:57 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:27:57 : data_processing : WARNING : Create a new column
14-10-2023 01:27:57 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:27:57 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:27:57 : data_processing : WARNING : Clean data done.......
14-10-2023 01:27:57 : root : INFO : Show dataframe :
14-10-2023 01:27:58 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 01:27:58 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 01:27:58 : validate : WARNING : print_data_schema done ...
14-10-2023 01:27:58 : root : INFO : --------------Application done----------------
14-10-2023 01:30:03 : root : INFO : Calling spark object
14-10-2023 01:30:03 : create_spark : INFO : start get_spark_object method
14-10-2023 01:30:03 : create_spark : INFO : master is local[*]
14-10-2023 01:30:08 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fcc810ad438>...
14-10-2023 01:30:08 : root : INFO : Validate spark object
14-10-2023 01:30:08 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:30:11 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:30:11 : validate : WARNING : Validation done ...
14-10-2023 01:30:11 : root : INFO : Load file 
14-10-2023 01:30:11 : ingest : WARNING : Start load file method ======
14-10-2023 01:30:16 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:30:16 : root : INFO : Validate dataframe
14-10-2023 01:30:16 : ingest : WARNING : Start validate df method =====
14-10-2023 01:30:17 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:30:17 : root : INFO : Processing dataframe
14-10-2023 01:30:17 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:30:17 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:30:17 : data_processing : WARNING : Create a new column
14-10-2023 01:30:17 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:30:17 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:30:17 : data_processing : WARNING : Clean data done.......
14-10-2023 01:30:17 : root : INFO : Show dataframe :
14-10-2023 01:30:17 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 01:30:17 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 01:30:17 : validate : WARNING : print_data_schema done ...
14-10-2023 01:30:17 : root : INFO : --------------Application done----------------
14-10-2023 01:30:33 : root : INFO : Calling spark object
14-10-2023 01:30:33 : create_spark : INFO : start get_spark_object method
14-10-2023 01:30:33 : create_spark : INFO : master is local[*]
14-10-2023 01:30:38 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f370c2fb518>...
14-10-2023 01:30:38 : root : INFO : Validate spark object
14-10-2023 01:30:38 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:30:41 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:30:41 : validate : WARNING : Validation done ...
14-10-2023 01:30:41 : root : INFO : Load file 
14-10-2023 01:30:41 : ingest : WARNING : Start load file method ======
14-10-2023 01:30:45 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:30:45 : root : INFO : Validate dataframe
14-10-2023 01:30:45 : ingest : WARNING : Start validate df method =====
14-10-2023 01:30:46 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:30:46 : root : INFO : Processing dataframe
14-10-2023 01:30:46 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:30:46 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:30:46 : data_processing : WARNING : Create a new column
14-10-2023 01:30:46 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:30:46 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:30:46 : data_processing : WARNING : Clean data done.......
14-10-2023 01:30:46 : root : INFO : Show dataframe :
14-10-2023 01:30:47 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(last_name,StringType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(first_name,StringType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 01:30:47 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 01:30:47 : validate : WARNING : print_data_schema done ...
14-10-2023 01:30:47 : root : INFO : --------------Application done----------------
14-10-2023 01:31:08 : root : INFO : Calling spark object
14-10-2023 01:31:08 : create_spark : INFO : start get_spark_object method
14-10-2023 01:31:08 : create_spark : INFO : master is local[*]
14-10-2023 01:31:14 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f5fceb26518>...
14-10-2023 01:31:14 : root : INFO : Validate spark object
14-10-2023 01:31:14 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:31:18 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:31:18 : validate : WARNING : Validation done ...
14-10-2023 01:31:18 : root : INFO : Load file 
14-10-2023 01:31:18 : ingest : WARNING : Start load file method ======
14-10-2023 01:31:23 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:31:23 : root : INFO : Validate dataframe
14-10-2023 01:31:23 : ingest : WARNING : Start validate df method =====
14-10-2023 01:31:24 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:31:24 : root : INFO : Processing dataframe
14-10-2023 01:31:24 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:31:24 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:31:24 : data_processing : WARNING : Create a new column
14-10-2023 01:31:24 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:31:24 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:31:24 : data_processing : WARNING : Clean data done.......
14-10-2023 01:31:24 : root : INFO : Show dataframe :
14-10-2023 01:31:25 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 01:31:25 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 01:31:25 : validate : WARNING : print_data_schema done ...
14-10-2023 01:31:25 : root : INFO : --------------Application done----------------
14-10-2023 01:47:18 : root : INFO : Calling spark object
14-10-2023 01:47:18 : create_spark : INFO : start get_spark_object method
14-10-2023 01:47:18 : create_spark : INFO : master is local[*]
14-10-2023 01:47:23 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fec690353c8>...
14-10-2023 01:47:23 : root : INFO : Validate spark object
14-10-2023 01:47:23 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:47:26 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:47:26 : validate : WARNING : Validation done ...
14-10-2023 01:47:26 : root : INFO : Load file 
14-10-2023 01:47:26 : ingest : WARNING : Start load file method ======
14-10-2023 01:47:31 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:47:31 : root : INFO : Validate dataframe
14-10-2023 01:47:31 : ingest : WARNING : Start validate df method =====
14-10-2023 01:47:32 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:47:32 : root : INFO : Processing dataframe
14-10-2023 01:47:32 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:47:32 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:47:32 : data_processing : WARNING : Create a new column
14-10-2023 01:47:32 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:47:32 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:47:32 : data_processing : WARNING : Check null value
14-10-2023 01:47:32 : data_processing : WARNING : Clean data done.......
14-10-2023 01:47:32 : root : INFO : Show dataframe :
14-10-2023 01:47:34 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:47:34 : validate : WARNING : 		StructField(presc_id,LongType,false)
14-10-2023 01:47:34 : validate : WARNING : print_data_schema done ...
14-10-2023 01:47:34 : root : INFO : --------------Application done----------------
14-10-2023 01:50:32 : root : INFO : Calling spark object
14-10-2023 01:50:32 : create_spark : INFO : start get_spark_object method
14-10-2023 01:50:32 : create_spark : INFO : master is local[*]
14-10-2023 01:50:37 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fbec96a03c8>...
14-10-2023 01:50:37 : root : INFO : Validate spark object
14-10-2023 01:50:37 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:50:40 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:50:40 : validate : WARNING : Validation done ...
14-10-2023 01:50:40 : root : INFO : Load file 
14-10-2023 01:50:40 : ingest : WARNING : Start load file method ======
14-10-2023 01:50:44 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:50:44 : root : INFO : Validate dataframe
14-10-2023 01:50:44 : ingest : WARNING : Start validate df method =====
14-10-2023 01:50:45 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:50:45 : root : INFO : Processing dataframe
14-10-2023 01:50:45 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:50:45 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:50:46 : data_processing : WARNING : Create a new column
14-10-2023 01:50:46 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:50:46 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:50:46 : data_processing : WARNING : Check null value
14-10-2023 01:50:46 : data_processing : ERROR : An error occurs in clean_data(): Invalid argument, not a string or column: DataFrame[presc_id: int, city: string, state: string, desc: string, drug_name: string, total_claim_count: int, total_day_supply: int, years_of_exp: int, Country_name: string, full_name: string] of type <class 'pyspark.sql.dataframe.DataFrame'>. For column literals, use 'lit', 'array', 'struct' or 'create_map' function.
14-10-2023 01:50:46 : root : ERROR : An error in main() : Invalid argument, not a string or column: DataFrame[presc_id: int, city: string, state: string, desc: string, drug_name: string, total_claim_count: int, total_day_supply: int, years_of_exp: int, Country_name: string, full_name: string] of type <class 'pyspark.sql.dataframe.DataFrame'>. For column literals, use 'lit', 'array', 'struct' or 'create_map' function.
14-10-2023 01:50:46 : root : INFO : --------------Application done----------------
14-10-2023 01:54:47 : root : INFO : Calling spark object
14-10-2023 01:54:47 : create_spark : INFO : start get_spark_object method
14-10-2023 01:54:47 : create_spark : INFO : master is local[*]
14-10-2023 01:54:52 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f9ac6556400>...
14-10-2023 01:54:52 : root : INFO : Validate spark object
14-10-2023 01:54:52 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:54:55 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:54:55 : validate : WARNING : Validation done ...
14-10-2023 01:54:55 : root : INFO : Load file 
14-10-2023 01:54:55 : ingest : WARNING : Start load file method ======
14-10-2023 01:54:59 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:54:59 : root : INFO : Validate dataframe
14-10-2023 01:54:59 : ingest : WARNING : Start validate df method =====
14-10-2023 01:55:01 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:55:01 : root : INFO : Processing dataframe
14-10-2023 01:55:01 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:55:01 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:55:01 : data_processing : WARNING : Create a new column
14-10-2023 01:55:01 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:55:01 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:55:01 : data_processing : WARNING : Check null value
14-10-2023 01:55:01 : data_processing : WARNING : Clean data done.......
14-10-2023 01:55:01 : root : INFO : Show dataframe :
14-10-2023 01:55:02 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:55:02 : validate : WARNING : 		StructField(presc_id,LongType,false)
14-10-2023 01:55:02 : validate : WARNING : print_data_schema done ...
14-10-2023 01:55:02 : root : INFO : --------------Application done----------------
14-10-2023 01:55:26 : root : INFO : Calling spark object
14-10-2023 01:55:26 : create_spark : INFO : start get_spark_object method
14-10-2023 01:55:26 : create_spark : INFO : master is local[*]
14-10-2023 01:55:32 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7ff50d1e9470>...
14-10-2023 01:55:32 : root : INFO : Validate spark object
14-10-2023 01:55:32 : validate : WARNING : Start get_current_date method=====
14-10-2023 01:55:36 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 01:55:36 : validate : WARNING : Validation done ...
14-10-2023 01:55:36 : root : INFO : Load file 
14-10-2023 01:55:36 : ingest : WARNING : Start load file method ======
14-10-2023 01:55:40 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 01:55:40 : root : INFO : Validate dataframe
14-10-2023 01:55:40 : ingest : WARNING : Start validate df method =====
14-10-2023 01:55:41 : ingest : WARNING : Number record df: 1329329
14-10-2023 01:55:41 : root : INFO : Processing dataframe
14-10-2023 01:55:41 : data_processing : WARNING : Start clean data method ====
14-10-2023 01:55:41 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 01:55:41 : data_processing : WARNING : Create a new column
14-10-2023 01:55:41 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 01:55:41 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 01:55:41 : data_processing : WARNING : Check null value
14-10-2023 01:55:42 : data_processing : WARNING : Clean data done.......
14-10-2023 01:55:42 : root : INFO : Show dataframe :
14-10-2023 01:55:44 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 01:55:44 : validate : WARNING : 		StructField(presc_id,LongType,false)
14-10-2023 01:55:44 : validate : WARNING : print_data_schema done ...
14-10-2023 01:55:44 : root : INFO : --------------Application done----------------
14-10-2023 02:09:02 : root : INFO : Calling spark object
14-10-2023 02:09:02 : create_spark : INFO : start get_spark_object method
14-10-2023 02:09:02 : create_spark : INFO : master is local[*]
14-10-2023 02:09:07 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7efe22371470>...
14-10-2023 02:09:07 : root : INFO : Validate spark object
14-10-2023 02:09:07 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:09:10 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:09:10 : validate : WARNING : Validation done ...
14-10-2023 02:09:10 : root : INFO : Load file 
14-10-2023 02:09:10 : ingest : WARNING : Start load file method ======
14-10-2023 02:09:15 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:09:15 : root : INFO : Validate dataframe
14-10-2023 02:09:15 : ingest : WARNING : Start validate df method =====
14-10-2023 02:09:16 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:09:16 : root : INFO : Processing dataframe
14-10-2023 02:09:16 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:09:16 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:09:16 : data_processing : WARNING : Create a new column
14-10-2023 02:09:16 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:09:16 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:09:16 : data_processing : WARNING : Check null value
14-10-2023 02:09:16 : data_processing : ERROR : An error occurs in clean_data(): 'Column' object is not callable
14-10-2023 02:09:16 : root : ERROR : An error in main() : 'Column' object is not callable
14-10-2023 02:09:16 : root : INFO : --------------Application done----------------
14-10-2023 02:11:29 : root : INFO : Calling spark object
14-10-2023 02:11:29 : create_spark : INFO : start get_spark_object method
14-10-2023 02:11:29 : create_spark : INFO : master is local[*]
14-10-2023 02:11:34 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f6cdb808390>...
14-10-2023 02:11:34 : root : INFO : Validate spark object
14-10-2023 02:11:34 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:11:37 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:11:37 : validate : WARNING : Validation done ...
14-10-2023 02:11:37 : root : INFO : Load file 
14-10-2023 02:11:37 : ingest : WARNING : Start load file method ======
14-10-2023 02:11:41 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:11:41 : root : INFO : Validate dataframe
14-10-2023 02:11:41 : ingest : WARNING : Start validate df method =====
14-10-2023 02:11:42 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:11:42 : root : INFO : Processing dataframe
14-10-2023 02:11:42 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:11:42 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:11:42 : data_processing : WARNING : Create a new column
14-10-2023 02:11:42 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:11:42 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:11:42 : data_processing : WARNING : Check null value
14-10-2023 02:11:42 : data_processing : WARNING : Clean data done.......
14-10-2023 02:11:42 : root : INFO : Show dataframe :
14-10-2023 02:11:42 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:11:42 : validate : WARNING : 		StructField(CASE WHEN (presc_id IS NULL) THEN 1 END,IntegerType,true)
14-10-2023 02:11:42 : validate : WARNING : print_data_schema done ...
14-10-2023 02:11:42 : root : INFO : --------------Application done----------------
14-10-2023 02:14:34 : root : INFO : Calling spark object
14-10-2023 02:14:34 : create_spark : INFO : start get_spark_object method
14-10-2023 02:14:34 : create_spark : INFO : master is local[*]
14-10-2023 02:14:39 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f1cc95b3b70>...
14-10-2023 02:14:39 : root : INFO : Validate spark object
14-10-2023 02:14:39 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:14:42 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:14:42 : validate : WARNING : Validation done ...
14-10-2023 02:14:42 : root : INFO : Load file 
14-10-2023 02:14:42 : ingest : WARNING : Start load file method ======
14-10-2023 02:14:46 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:14:46 : root : INFO : Validate dataframe
14-10-2023 02:14:46 : ingest : WARNING : Start validate df method =====
14-10-2023 02:14:47 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:14:47 : root : INFO : Processing dataframe
14-10-2023 02:14:47 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:14:47 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:14:47 : data_processing : WARNING : Create a new column
14-10-2023 02:14:47 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:14:48 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:14:48 : data_processing : WARNING : Check null value
14-10-2023 02:14:48 : data_processing : ERROR : An error occurs in clean_data(): [DATATYPE_MISMATCH.BINARY_OP_DIFF_TYPES] Cannot resolve "(presc_id OR isnan(presc_id))" due to data type mismatch: the left and right operands of the binary operator have incompatible types ("INT" and "BOOLEAN").;
'Project [unresolvedalias(CASE WHEN isnull((presc_id#90 OR isnan(cast(presc_id#90 as double)))) THEN 1 END, Some(org.apache.spark.sql.Column$$Lambda$3517/657328332@60bb4770))]
+- Project [presc_id#90, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#131, Country_name#107, full_name#143]
   +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#131, Country_name#107, concat_ws( , first_name#92, last_name#91) AS full_name#143]
      +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, cast(years_of_exp#119 as int) AS years_of_exp#131, Country_name#107]
         +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, regexp_replace(years_of_exp#40, ^=, , 1) AS years_of_exp#119, Country_name#107]
            +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#40, USA AS Country_name#107]
               +- Project [npi#19 AS presc_id#90, nppes_provider_last_org_name#20 AS last_name#91, nppes_provider_first_name#21 AS first_name#92, nppes_provider_city#22 AS city#93, nppes_provider_state#23 AS state#94, specialty_description#24 AS desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#40]
                  +- Relation [npi#19,nppes_provider_last_org_name#20,nppes_provider_first_name#21,nppes_provider_city#22,nppes_provider_state#23,specialty_description#24,description_flag#25,drug_name#26,generic_name#27,bene_count#28,total_claim_count#29,total_30_day_fill_count#30,total_day_supply#31,total_drug_cost#32,bene_count_ge65#33,bene_count_ge65_suppress_flag#34,total_claim_count_ge65#35,ge65_suppress_flag#36,total_30_day_fill_count_ge65#37,total_day_supply_ge65#38,total_drug_cost_ge65#39,years_of_exp#40] csv

14-10-2023 02:14:48 : root : ERROR : An error in main() : [DATATYPE_MISMATCH.BINARY_OP_DIFF_TYPES] Cannot resolve "(presc_id OR isnan(presc_id))" due to data type mismatch: the left and right operands of the binary operator have incompatible types ("INT" and "BOOLEAN").;
'Project [unresolvedalias(CASE WHEN isnull((presc_id#90 OR isnan(cast(presc_id#90 as double)))) THEN 1 END, Some(org.apache.spark.sql.Column$$Lambda$3517/657328332@60bb4770))]
+- Project [presc_id#90, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#131, Country_name#107, full_name#143]
   +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#131, Country_name#107, concat_ws( , first_name#92, last_name#91) AS full_name#143]
      +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, cast(years_of_exp#119 as int) AS years_of_exp#131, Country_name#107]
         +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, regexp_replace(years_of_exp#40, ^=, , 1) AS years_of_exp#119, Country_name#107]
            +- Project [presc_id#90, last_name#91, first_name#92, city#93, state#94, desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#40, USA AS Country_name#107]
               +- Project [npi#19 AS presc_id#90, nppes_provider_last_org_name#20 AS last_name#91, nppes_provider_first_name#21 AS first_name#92, nppes_provider_city#22 AS city#93, nppes_provider_state#23 AS state#94, specialty_description#24 AS desc#95, drug_name#26, total_claim_count#29, total_day_supply#31, years_of_exp#40]
                  +- Relation [npi#19,nppes_provider_last_org_name#20,nppes_provider_first_name#21,nppes_provider_city#22,nppes_provider_state#23,specialty_description#24,description_flag#25,drug_name#26,generic_name#27,bene_count#28,total_claim_count#29,total_30_day_fill_count#30,total_day_supply#31,total_drug_cost#32,bene_count_ge65#33,bene_count_ge65_suppress_flag#34,total_claim_count_ge65#35,ge65_suppress_flag#36,total_30_day_fill_count_ge65#37,total_day_supply_ge65#38,total_drug_cost_ge65#39,years_of_exp#40] csv

14-10-2023 02:14:48 : root : INFO : --------------Application done----------------
14-10-2023 02:16:58 : root : INFO : Calling spark object
14-10-2023 02:16:58 : create_spark : INFO : start get_spark_object method
14-10-2023 02:16:58 : create_spark : INFO : master is local[*]
14-10-2023 02:17:03 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f57e57803c8>...
14-10-2023 02:17:03 : root : INFO : Validate spark object
14-10-2023 02:17:03 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:17:06 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:17:06 : validate : WARNING : Validation done ...
14-10-2023 02:17:06 : root : INFO : Load file 
14-10-2023 02:17:06 : ingest : WARNING : Start load file method ======
14-10-2023 02:17:11 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:17:11 : root : INFO : Validate dataframe
14-10-2023 02:17:11 : ingest : WARNING : Start validate df method =====
14-10-2023 02:17:12 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:17:12 : root : INFO : Processing dataframe
14-10-2023 02:17:12 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:17:12 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:17:12 : data_processing : WARNING : Create a new column
14-10-2023 02:17:12 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:17:12 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:17:12 : data_processing : WARNING : Check null value
14-10-2023 02:17:12 : data_processing : WARNING : Clean data done.......
14-10-2023 02:17:12 : root : INFO : Show dataframe :
14-10-2023 02:17:12 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:17:12 : validate : WARNING : 		StructField(CASE WHEN ((presc_id IS NULL) OR isnan(presc_id)) THEN 1 END,IntegerType,true)
14-10-2023 02:17:12 : validate : WARNING : print_data_schema done ...
14-10-2023 02:17:12 : root : INFO : --------------Application done----------------
14-10-2023 02:17:34 : root : INFO : Calling spark object
14-10-2023 02:17:34 : create_spark : INFO : start get_spark_object method
14-10-2023 02:17:34 : create_spark : INFO : master is local[*]
14-10-2023 02:17:38 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f277cdb7470>...
14-10-2023 02:17:38 : root : INFO : Validate spark object
14-10-2023 02:17:38 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:17:42 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:17:42 : validate : WARNING : Validation done ...
14-10-2023 02:17:42 : root : INFO : Load file 
14-10-2023 02:17:42 : ingest : WARNING : Start load file method ======
14-10-2023 02:17:46 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:17:46 : root : INFO : Validate dataframe
14-10-2023 02:17:46 : ingest : WARNING : Start validate df method =====
14-10-2023 02:17:47 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:17:47 : root : INFO : Processing dataframe
14-10-2023 02:17:47 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:17:47 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:17:47 : data_processing : WARNING : Create a new column
14-10-2023 02:17:47 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:17:47 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:17:47 : data_processing : WARNING : Check null value
14-10-2023 02:17:47 : data_processing : WARNING : Clean data done.......
14-10-2023 02:17:47 : root : INFO : Show dataframe :
14-10-2023 02:17:48 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:17:48 : validate : WARNING : 		StructField(CASE WHEN ((presc_id IS NULL) OR isnan(presc_id)) THEN 1 END,IntegerType,true)
14-10-2023 02:17:48 : validate : WARNING : print_data_schema done ...
14-10-2023 02:17:48 : root : INFO : --------------Application done----------------
14-10-2023 02:21:47 : root : INFO : Calling spark object
14-10-2023 02:21:47 : create_spark : INFO : start get_spark_object method
14-10-2023 02:21:47 : create_spark : INFO : master is local[*]
14-10-2023 02:21:52 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f080c289ba8>...
14-10-2023 02:21:52 : root : INFO : Validate spark object
14-10-2023 02:21:52 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:21:57 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:21:57 : validate : WARNING : Validation done ...
14-10-2023 02:21:57 : root : INFO : Load file 
14-10-2023 02:21:57 : ingest : WARNING : Start load file method ======
14-10-2023 02:22:01 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:22:01 : root : INFO : Validate dataframe
14-10-2023 02:22:01 : ingest : WARNING : Start validate df method =====
14-10-2023 02:22:03 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:22:03 : root : INFO : Processing dataframe
14-10-2023 02:22:03 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:22:03 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:22:03 : data_processing : WARNING : Create a new column
14-10-2023 02:22:03 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:22:03 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:22:03 : data_processing : WARNING : Check null value
14-10-2023 02:22:03 : data_processing : WARNING : Clean data done.......
14-10-2023 02:22:03 : root : INFO : Show dataframe :
14-10-2023 02:22:06 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:22:06 : validate : WARNING : 		StructField(presc_id,LongType,false)
14-10-2023 02:22:06 : validate : WARNING : print_data_schema done ...
14-10-2023 02:22:06 : root : INFO : --------------Application done----------------
14-10-2023 02:23:03 : root : INFO : Calling spark object
14-10-2023 02:23:03 : create_spark : INFO : start get_spark_object method
14-10-2023 02:23:03 : create_spark : INFO : master is local[*]
14-10-2023 02:23:07 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f1bbdf49438>...
14-10-2023 02:23:07 : root : INFO : Validate spark object
14-10-2023 02:23:07 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:23:11 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:23:11 : validate : WARNING : Validation done ...
14-10-2023 02:23:11 : root : INFO : Load file 
14-10-2023 02:23:11 : ingest : WARNING : Start load file method ======
14-10-2023 02:23:15 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:23:15 : root : INFO : Validate dataframe
14-10-2023 02:23:15 : ingest : WARNING : Start validate df method =====
14-10-2023 02:23:16 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:23:16 : root : INFO : Processing dataframe
14-10-2023 02:23:16 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:23:16 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:23:16 : data_processing : WARNING : Create a new column
14-10-2023 02:23:16 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:23:16 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:23:16 : data_processing : WARNING : Check null value
14-10-2023 02:23:17 : data_processing : WARNING : Clean data done.......
14-10-2023 02:23:17 : root : INFO : Show dataframe :
14-10-2023 02:23:27 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(presc_id,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(city,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(state,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(desc,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(drug_name,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(total_claim_count,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(total_day_supply,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(years_of_exp,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(Country_name,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : 		StructField(full_name,LongType,false)
14-10-2023 02:23:27 : validate : WARNING : print_data_schema done ...
14-10-2023 02:23:27 : root : INFO : --------------Application done----------------
14-10-2023 02:30:17 : root : INFO : Calling spark object
14-10-2023 02:30:17 : create_spark : INFO : start get_spark_object method
14-10-2023 02:30:17 : create_spark : INFO : master is local[*]
14-10-2023 02:30:22 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f498e99d438>...
14-10-2023 02:30:22 : root : INFO : Validate spark object
14-10-2023 02:30:22 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:30:26 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:30:26 : validate : WARNING : Validation done ...
14-10-2023 02:30:26 : root : INFO : Load file 
14-10-2023 02:30:26 : ingest : WARNING : Start load file method ======
14-10-2023 02:30:30 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:30:30 : root : INFO : Validate dataframe
14-10-2023 02:30:30 : ingest : WARNING : Start validate df method =====
14-10-2023 02:30:31 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:30:31 : root : INFO : Processing dataframe
14-10-2023 02:30:31 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:30:31 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:30:31 : data_processing : WARNING : Create a new column
14-10-2023 02:30:31 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:30:31 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:30:31 : data_processing : WARNING : Check null value
14-10-2023 02:30:32 : data_processing : WARNING : Drop null value
14-10-2023 02:30:32 : data_processing : WARNING : Clean data done.......
14-10-2023 02:30:32 : root : INFO : Show dataframe :
14-10-2023 02:30:42 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(presc_id,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(city,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(state,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(desc,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(drug_name,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(total_claim_count,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(total_day_supply,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(years_of_exp,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(Country_name,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : 		StructField(full_name,LongType,false)
14-10-2023 02:30:42 : validate : WARNING : print_data_schema done ...
14-10-2023 02:30:42 : root : INFO : --------------Application done----------------
14-10-2023 02:31:42 : root : INFO : Calling spark object
14-10-2023 02:31:42 : create_spark : INFO : start get_spark_object method
14-10-2023 02:31:42 : create_spark : INFO : master is local[*]
14-10-2023 02:31:46 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f023f064470>...
14-10-2023 02:31:46 : root : INFO : Validate spark object
14-10-2023 02:31:46 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:31:50 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:31:50 : validate : WARNING : Validation done ...
14-10-2023 02:31:50 : root : INFO : Load file 
14-10-2023 02:31:50 : ingest : WARNING : Start load file method ======
14-10-2023 02:31:54 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:31:54 : root : INFO : Validate dataframe
14-10-2023 02:31:54 : ingest : WARNING : Start validate df method =====
14-10-2023 02:31:55 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:31:55 : root : INFO : Processing dataframe
14-10-2023 02:31:55 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:31:55 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:31:55 : data_processing : WARNING : Create a new column
14-10-2023 02:31:55 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:31:55 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:31:55 : data_processing : WARNING : Check null value
14-10-2023 02:32:06 : data_processing : WARNING : Drop null value
14-10-2023 02:32:06 : data_processing : WARNING : Clean data done.......
14-10-2023 02:32:06 : root : INFO : Show dataframe :
14-10-2023 02:32:06 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 02:32:06 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 02:32:06 : validate : WARNING : print_data_schema done ...
14-10-2023 02:32:06 : root : INFO : --------------Application done----------------
14-10-2023 02:33:17 : root : INFO : Calling spark object
14-10-2023 02:33:17 : create_spark : INFO : start get_spark_object method
14-10-2023 02:33:17 : create_spark : INFO : master is local[*]
14-10-2023 02:33:21 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f791d59ebe0>...
14-10-2023 02:33:21 : root : INFO : Validate spark object
14-10-2023 02:33:21 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:33:25 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:33:25 : validate : WARNING : Validation done ...
14-10-2023 02:33:25 : root : INFO : Load file 
14-10-2023 02:33:25 : ingest : WARNING : Start load file method ======
14-10-2023 02:33:28 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:33:28 : root : INFO : Validate dataframe
14-10-2023 02:33:28 : ingest : WARNING : Start validate df method =====
14-10-2023 02:33:29 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:33:29 : root : INFO : Processing dataframe
14-10-2023 02:33:29 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:33:29 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:33:30 : data_processing : WARNING : Create a new column
14-10-2023 02:33:30 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:33:30 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:33:30 : data_processing : WARNING : Check null value
14-10-2023 02:33:41 : data_processing : WARNING : Drop null value
14-10-2023 02:33:51 : data_processing : WARNING : Clean data done.......
14-10-2023 02:33:51 : root : INFO : Show dataframe :
14-10-2023 02:33:52 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 02:33:52 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 02:33:52 : validate : WARNING : print_data_schema done ...
14-10-2023 02:33:52 : root : INFO : --------------Application done----------------
14-10-2023 02:42:57 : root : INFO : Calling spark object
14-10-2023 02:42:57 : create_spark : INFO : start get_spark_object method
14-10-2023 02:42:57 : create_spark : INFO : master is local[*]
14-10-2023 02:43:02 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe8835bd470>...
14-10-2023 02:43:02 : root : INFO : Validate spark object
14-10-2023 02:43:02 : validate : WARNING : Start get_current_date method=====
14-10-2023 02:43:05 : validate : WARNING : Validate spark object with current date :2023-10-14
14-10-2023 02:43:05 : validate : WARNING : Validation done ...
14-10-2023 02:43:05 : root : INFO : Load file 
14-10-2023 02:43:05 : ingest : WARNING : Start load file method ======
14-10-2023 02:43:09 : ingest : WARNING : Load file done which is of csv..........
14-10-2023 02:43:09 : root : INFO : Validate dataframe
14-10-2023 02:43:09 : ingest : WARNING : Start validate df method =====
14-10-2023 02:43:11 : ingest : WARNING : Number record df: 1329329
14-10-2023 02:43:11 : root : INFO : Processing dataframe
14-10-2023 02:43:11 : data_processing : WARNING : Start clean data method ====
14-10-2023 02:43:11 : data_processing : WARNING : Selecting a few columns and rename
14-10-2023 02:43:11 : data_processing : WARNING : Create a new column
14-10-2023 02:43:11 : data_processing : WARNING : Convert "years_of_exp" from string to int
14-10-2023 02:43:11 : data_processing : WARNING : Create full name column with concating columns and drop column
14-10-2023 02:43:11 : data_processing : WARNING : Check null value
14-10-2023 02:43:21 : data_processing : WARNING : Drop null value
14-10-2023 02:43:31 : data_processing : WARNING : Clean data done.......
14-10-2023 02:43:31 : root : INFO : Show dataframe :
14-10-2023 02:43:32 : validate : WARNING : Start print_data_schema method ====(Presc_df)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(presc_id,IntegerType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(city,StringType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(state,StringType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(desc,StringType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(drug_name,StringType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(total_claim_count,IntegerType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(total_day_supply,IntegerType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(years_of_exp,IntegerType,true)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(Country_name,StringType,false)
14-10-2023 02:43:32 : validate : WARNING : 		StructField(full_name,StringType,false)
14-10-2023 02:43:32 : validate : WARNING : print_data_schema done ...
14-10-2023 02:43:32 : root : INFO : --------------Application done----------------
16-10-2023 08:40:33 : root : INFO : Calling spark object
16-10-2023 08:40:33 : create_spark : INFO : start get_spark_object method
16-10-2023 08:40:33 : create_spark : INFO : master is local[*]
16-10-2023 08:40:38 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fad775985e0>...
16-10-2023 08:40:38 : root : INFO : Validate spark object
16-10-2023 08:40:38 : validate : WARNING : Start get_current_date method=====
16-10-2023 08:40:44 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 08:40:44 : validate : WARNING : Validation done ...
16-10-2023 08:40:44 : root : INFO : Load file 
16-10-2023 08:40:44 : ingest : WARNING : Start load file method ======
16-10-2023 08:40:49 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 08:40:49 : root : INFO : Validate dataframe
16-10-2023 08:40:49 : ingest : WARNING : Start validate df method =====
16-10-2023 08:40:51 : ingest : WARNING : Number record df: 1329329
16-10-2023 08:40:51 : root : INFO : Processing dataframe
16-10-2023 08:40:51 : data_processing : WARNING : Start clean data method ====
16-10-2023 08:40:51 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 08:40:51 : data_processing : WARNING : Create a new column
16-10-2023 08:40:51 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 08:40:51 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 08:40:51 : data_processing : WARNING : Check null value
16-10-2023 08:41:03 : data_processing : WARNING : Drop null value
16-10-2023 08:41:14 : data_processing : WARNING : Clean data done.......
16-10-2023 08:41:14 : root : INFO : Show dataframe :
16-10-2023 08:41:14 : validate : WARNING : Start print_data_schema method ====(Presc_df)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('presc_id', IntegerType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('city', StringType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('state', StringType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('desc', StringType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('drug_name', StringType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('total_claim_count', IntegerType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('total_day_supply', IntegerType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('years_of_exp', IntegerType(), True)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('Country_name', StringType(), False)
16-10-2023 08:41:14 : validate : WARNING : 		StructField('full_name', StringType(), False)
16-10-2023 08:41:14 : validate : WARNING : print_data_schema done ...
16-10-2023 08:41:14 : root : INFO : --------------Application done----------------
16-10-2023 08:56:23 : root : INFO : Calling spark object
16-10-2023 08:56:23 : create_spark : INFO : start get_spark_object method
16-10-2023 08:56:23 : create_spark : INFO : master is local[*]
16-10-2023 08:56:28 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f7869ec45b0>...
16-10-2023 08:56:28 : root : INFO : Validate spark object
16-10-2023 08:56:28 : validate : WARNING : Start get_current_date method=====
16-10-2023 08:56:34 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 08:56:34 : validate : WARNING : Validation done ...
16-10-2023 08:56:34 : root : INFO : Load file 
16-10-2023 08:56:34 : ingest : WARNING : Start load file method ======
16-10-2023 08:56:34 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 08:56:34 : ingest : WARNING : Start load file method ======
16-10-2023 08:56:39 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 08:56:39 : root : INFO : Validate dataframe
16-10-2023 08:56:39 : ingest : WARNING : Start validate df method =====
16-10-2023 08:56:40 : ingest : WARNING : Number record df: 28338
16-10-2023 08:56:40 : ingest : WARNING : Start validate df method =====
16-10-2023 08:56:41 : ingest : WARNING : Number record df: 1329329
16-10-2023 08:56:41 : root : INFO : Processing dataframe
16-10-2023 08:56:41 : data_processing : WARNING : Start clean data method ====
16-10-2023 08:56:41 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 08:56:41 : data_processing : WARNING : Create a new column
16-10-2023 08:56:41 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 08:56:41 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 08:56:41 : data_processing : WARNING : Drop null and replace value
16-10-2023 08:56:44 : data_processing : WARNING : Clean data done.......
16-10-2023 08:56:44 : root : INFO : Check null after processing
16-10-2023 08:56:44 : root : ERROR : An error in main() : check_null_df() missing 1 required positional argument: 'df_name'
16-10-2023 08:56:44 : root : INFO : --------------Application done----------------
16-10-2023 08:58:06 : root : INFO : Calling spark object
16-10-2023 08:58:06 : create_spark : INFO : start get_spark_object method
16-10-2023 08:58:06 : create_spark : INFO : master is local[*]
16-10-2023 08:58:13 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f6ec1e815b0>...
16-10-2023 08:58:13 : root : INFO : Validate spark object
16-10-2023 08:58:13 : validate : WARNING : Start get_current_date method=====
16-10-2023 08:58:18 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 08:58:18 : validate : WARNING : Validation done ...
16-10-2023 08:58:18 : root : INFO : Load file 
16-10-2023 08:58:18 : ingest : WARNING : Start load file method ======
16-10-2023 08:58:19 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 08:58:19 : ingest : WARNING : Start load file method ======
16-10-2023 08:58:24 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 08:58:24 : root : INFO : Validate dataframe
16-10-2023 08:58:24 : ingest : WARNING : Start validate df method =====
16-10-2023 08:58:26 : ingest : WARNING : Number record df: 28338
16-10-2023 08:58:26 : ingest : WARNING : Start validate df method =====
16-10-2023 08:58:30 : ingest : WARNING : Number record df: 1329329
16-10-2023 08:58:30 : root : INFO : Processing dataframe
16-10-2023 08:58:30 : data_processing : WARNING : Start clean data method ====
16-10-2023 08:58:30 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 08:58:30 : data_processing : WARNING : Create a new column
16-10-2023 08:58:30 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 08:58:30 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 08:58:30 : data_processing : WARNING : Drop null and replace value
16-10-2023 08:58:34 : data_processing : WARNING : Clean data done.......
16-10-2023 08:58:34 : root : INFO : Check null after processing
16-10-2023 08:58:34 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 08:58:35 : validate : WARNING : check_null_df done ...
16-10-2023 08:58:37 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 08:58:37 : validate : WARNING : check_null_df done ...
16-10-2023 08:58:54 : root : INFO : --------------Application done----------------
16-10-2023 09:15:31 : root : INFO : Calling spark object
16-10-2023 09:15:31 : create_spark : INFO : start get_spark_object method
16-10-2023 09:15:31 : create_spark : INFO : master is local[*]
16-10-2023 09:15:38 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f935b81f580>...
16-10-2023 09:15:38 : root : INFO : Validate spark object
16-10-2023 09:15:38 : validate : WARNING : Start get_current_date method=====
16-10-2023 09:15:44 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 09:15:44 : validate : WARNING : Validation done ...
16-10-2023 09:15:44 : root : INFO : Load file 
16-10-2023 09:15:44 : ingest : WARNING : Start load file method ======
16-10-2023 09:15:45 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 09:15:45 : ingest : WARNING : Start load file method ======
16-10-2023 09:15:49 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 09:15:49 : root : INFO : Validate dataframe
16-10-2023 09:15:49 : ingest : WARNING : Start validate df method =====
16-10-2023 09:15:50 : ingest : WARNING : Number record df: 28338
16-10-2023 09:15:50 : ingest : WARNING : Start validate df method =====
16-10-2023 09:15:52 : ingest : WARNING : Number record df: 1329329
16-10-2023 09:15:52 : root : INFO : Processing dataframe
16-10-2023 09:15:52 : data_processing : WARNING : Start clean data method ====
16-10-2023 09:15:52 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 09:15:52 : data_processing : WARNING : Create a new column
16-10-2023 09:15:52 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 09:15:52 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 09:15:52 : data_processing : WARNING : Drop null and replace value
16-10-2023 09:15:55 : data_processing : WARNING : Clean data done.......
16-10-2023 09:15:55 : root : INFO : Check null after processing
16-10-2023 09:15:55 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 09:15:55 : validate : WARNING : check_null_df done ...
16-10-2023 09:15:57 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 09:15:57 : validate : WARNING : check_null_df done ...
16-10-2023 09:16:11 : root : INFO : Data transformation
16-10-2023 09:16:11 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 09:16:11 : data_transformation : WARNING : Count zip
16-10-2023 09:16:12 : data_transformation : WARNING : Data report done...........
16-10-2023 09:16:12 : root : INFO : --------------Application done----------------
16-10-2023 09:27:25 : root : INFO : Calling spark object
16-10-2023 09:27:25 : create_spark : INFO : start get_spark_object method
16-10-2023 09:27:25 : create_spark : INFO : master is local[*]
16-10-2023 09:27:30 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f64feea0bb0>...
16-10-2023 09:27:30 : root : INFO : Validate spark object
16-10-2023 09:27:30 : validate : WARNING : Start get_current_date method=====
16-10-2023 09:27:36 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 09:27:36 : validate : WARNING : Validation done ...
16-10-2023 09:27:36 : root : INFO : Load file 
16-10-2023 09:27:36 : ingest : WARNING : Start load file method ======
16-10-2023 09:27:36 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 09:27:36 : ingest : WARNING : Start load file method ======
16-10-2023 09:27:41 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 09:27:41 : root : INFO : Validate dataframe
16-10-2023 09:27:41 : ingest : WARNING : Start validate df method =====
16-10-2023 09:27:42 : ingest : WARNING : Number record df: 28338
16-10-2023 09:27:42 : ingest : WARNING : Start validate df method =====
16-10-2023 09:27:44 : ingest : WARNING : Number record df: 1329329
16-10-2023 09:27:44 : root : INFO : Processing dataframe
16-10-2023 09:27:44 : data_processing : WARNING : Start clean data method ====
16-10-2023 09:27:44 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 09:27:45 : data_processing : WARNING : Create a new column
16-10-2023 09:27:45 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 09:27:45 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 09:27:45 : data_processing : WARNING : Drop null and replace value
16-10-2023 09:27:49 : data_processing : WARNING : Clean data done.......
16-10-2023 09:27:49 : root : INFO : Check null after processing
16-10-2023 09:27:49 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 09:27:49 : validate : WARNING : check_null_df done ...
16-10-2023 09:27:51 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 09:27:51 : validate : WARNING : check_null_df done ...
16-10-2023 09:28:03 : root : INFO : Data transformation
16-10-2023 09:28:03 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 09:28:03 : data_transformation : WARNING : Count zip
16-10-2023 09:28:04 : data_transformation : WARNING : Data report done...........
16-10-2023 09:28:04 : root : INFO : --------------Application done----------------
16-10-2023 11:14:22 : root : INFO : Calling spark object
16-10-2023 11:14:22 : create_spark : INFO : start get_spark_object method
16-10-2023 11:14:22 : create_spark : INFO : master is local[*]
16-10-2023 11:14:26 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f7df95219a0>...
16-10-2023 11:14:26 : root : INFO : Validate spark object
16-10-2023 11:14:26 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:14:30 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:14:30 : validate : WARNING : Validation done ...
16-10-2023 11:14:30 : root : INFO : Load file 
16-10-2023 11:14:30 : ingest : WARNING : Start load file method ======
16-10-2023 11:14:31 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:14:31 : ingest : WARNING : Start load file method ======
16-10-2023 11:14:35 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:14:35 : root : INFO : Validate dataframe
16-10-2023 11:14:35 : ingest : WARNING : Start validate df method =====
16-10-2023 11:14:36 : ingest : WARNING : Number record df: 28338
16-10-2023 11:14:36 : ingest : WARNING : Start validate df method =====
16-10-2023 11:14:37 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:14:37 : root : INFO : Processing dataframe
16-10-2023 11:14:37 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:14:37 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:14:37 : data_processing : WARNING : Create a new column
16-10-2023 11:14:37 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:14:37 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:14:37 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:14:40 : data_processing : WARNING : Clean data done.......
16-10-2023 11:14:40 : root : INFO : Check null after processing
16-10-2023 11:14:40 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 11:14:40 : validate : WARNING : check_null_df done ...
16-10-2023 11:14:41 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 11:14:42 : validate : WARNING : check_null_df done ...
16-10-2023 11:14:54 : root : INFO : Data transformation
16-10-2023 11:14:54 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:14:54 : data_transformation : WARNING : Count zip
16-10-2023 11:14:54 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:14:54 : data_transformation : ERROR : An error occurs in data_report1 None
16-10-2023 11:14:54 : root : ERROR : An error in main() : 'DataFrame' object has no attribute 'grouBy'
16-10-2023 11:14:54 : root : INFO : --------------Application done----------------
16-10-2023 11:16:42 : root : INFO : Calling spark object
16-10-2023 11:16:42 : create_spark : INFO : start get_spark_object method
16-10-2023 11:16:42 : create_spark : INFO : master is local[*]
16-10-2023 11:16:47 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f35d34576d0>...
16-10-2023 11:16:47 : root : INFO : Validate spark object
16-10-2023 11:16:47 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:16:47 : root : ERROR : Exception while sending command.
Traceback (most recent call last):
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
16-10-2023 11:16:47 : root : ERROR : Exception while sending command.
Traceback (most recent call last):
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o14.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
16-10-2023 11:16:47 : validate : ERROR : An error occurs in get_current_date() : An error occurred while calling o25.sql
16-10-2023 11:16:47 : root : ERROR : An error in main() : An error occurred while calling o25.sql
16-10-2023 11:16:47 : root : INFO : --------------Application done----------------
16-10-2023 11:16:49 : root : INFO : Calling spark object
16-10-2023 11:16:49 : create_spark : INFO : start get_spark_object method
16-10-2023 11:16:49 : create_spark : INFO : master is local[*]
16-10-2023 11:16:54 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f966e6736d0>...
16-10-2023 11:16:54 : root : INFO : Validate spark object
16-10-2023 11:16:54 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:17:00 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:17:00 : validate : WARNING : Validation done ...
16-10-2023 11:17:00 : root : INFO : Load file 
16-10-2023 11:17:00 : ingest : WARNING : Start load file method ======
16-10-2023 11:17:01 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:17:01 : ingest : WARNING : Start load file method ======
16-10-2023 11:17:05 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:17:05 : root : INFO : Validate dataframe
16-10-2023 11:17:05 : ingest : WARNING : Start validate df method =====
16-10-2023 11:17:06 : ingest : WARNING : Number record df: 28338
16-10-2023 11:17:06 : ingest : WARNING : Start validate df method =====
16-10-2023 11:17:07 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:17:07 : root : INFO : Processing dataframe
16-10-2023 11:17:07 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:17:07 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:17:07 : data_processing : WARNING : Create a new column
16-10-2023 11:17:07 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:17:07 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:17:07 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:17:10 : data_processing : WARNING : Clean data done.......
16-10-2023 11:17:10 : root : INFO : Check null after processing
16-10-2023 11:17:10 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 11:17:10 : validate : WARNING : check_null_df done ...
16-10-2023 11:17:11 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 11:17:11 : validate : WARNING : check_null_df done ...
16-10-2023 11:17:24 : root : INFO : Data transformation
16-10-2023 11:17:24 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:17:24 : data_transformation : WARNING : Count zip
16-10-2023 11:17:24 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:17:24 : data_transformation : ERROR : An error occurs in data_report1 None
16-10-2023 11:17:24 : root : ERROR : An error in main() : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `state` cannot be resolved. Did you mean one of the following? [`lat`, `state_id`, `city`, `lng`, `state_name`].;
'Aggregate [city#2, 'state], [city#2, 'state, sum('total_claim_count) AS total_claim_count#542, count('presc_id) AS total_presc#544]
+- Project [city#2, city_ascii#3, state_id#4, state_name#5, county_fips#6, county_name#7, lat#8, lng#9, population#10, density#11, timezone#12, zips#13, split_and_count(zips#13)#513 AS zip_count#514]
   +- Relation [city#2,city_ascii#3,state_id#4,state_name#5,county_fips#6,county_name#7,lat#8,lng#9,population#10,density#11,timezone#12,zips#13] parquet

16-10-2023 11:17:24 : root : INFO : --------------Application done----------------
16-10-2023 11:21:14 : root : INFO : Calling spark object
16-10-2023 11:21:14 : create_spark : INFO : start get_spark_object method
16-10-2023 11:21:14 : create_spark : INFO : master is local[*]
16-10-2023 11:21:19 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f7a9768b6d0>...
16-10-2023 11:21:19 : root : INFO : Validate spark object
16-10-2023 11:21:19 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:21:25 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:21:25 : validate : WARNING : Validation done ...
16-10-2023 11:21:25 : root : INFO : Load file 
16-10-2023 11:21:25 : ingest : WARNING : Start load file method ======
16-10-2023 11:21:26 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:21:26 : ingest : WARNING : Start load file method ======
16-10-2023 11:21:30 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:21:30 : root : INFO : Validate dataframe
16-10-2023 11:21:30 : ingest : WARNING : Start validate df method =====
16-10-2023 11:21:31 : ingest : WARNING : Number record df: 28338
16-10-2023 11:21:31 : ingest : WARNING : Start validate df method =====
16-10-2023 11:21:32 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:21:32 : root : INFO : Processing dataframe
16-10-2023 11:21:32 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:21:32 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:21:32 : data_processing : WARNING : Create a new column
16-10-2023 11:21:32 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:21:32 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:21:32 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:21:35 : data_processing : WARNING : Clean data done.......
16-10-2023 11:21:35 : root : INFO : Check null after processing
16-10-2023 11:21:35 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 11:21:35 : validate : WARNING : check_null_df done ...
16-10-2023 11:21:36 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 11:21:36 : validate : WARNING : check_null_df done ...
16-10-2023 11:21:48 : root : INFO : Data transformation
16-10-2023 11:21:48 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:21:48 : data_transformation : WARNING : Count zip
16-10-2023 11:21:48 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:21:48 : data_transformation : ERROR : An error occurs in data_report1 None
16-10-2023 11:21:48 : root : ERROR : An error in main() : 'DataFrame' object has no attribute 'state'
16-10-2023 11:21:48 : root : INFO : --------------Application done----------------
16-10-2023 11:22:11 : root : INFO : Calling spark object
16-10-2023 11:22:11 : create_spark : INFO : start get_spark_object method
16-10-2023 11:22:11 : create_spark : INFO : master is local[*]
16-10-2023 11:22:16 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f9013c576d0>...
16-10-2023 11:22:16 : root : INFO : Validate spark object
16-10-2023 11:22:16 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:22:19 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:22:19 : validate : WARNING : Validation done ...
16-10-2023 11:22:19 : root : INFO : Load file 
16-10-2023 11:22:19 : ingest : WARNING : Start load file method ======
16-10-2023 11:22:20 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:22:20 : ingest : WARNING : Start load file method ======
16-10-2023 11:22:24 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:22:24 : root : INFO : Validate dataframe
16-10-2023 11:22:24 : ingest : WARNING : Start validate df method =====
16-10-2023 11:22:25 : ingest : WARNING : Number record df: 28338
16-10-2023 11:22:25 : ingest : WARNING : Start validate df method =====
16-10-2023 11:22:26 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:22:26 : root : INFO : Processing dataframe
16-10-2023 11:22:26 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:22:26 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:22:26 : data_processing : WARNING : Create a new column
16-10-2023 11:22:26 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:22:26 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:22:26 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:22:28 : data_processing : WARNING : Clean data done.......
16-10-2023 11:22:28 : root : INFO : Check null after processing
16-10-2023 11:22:28 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 11:22:28 : validate : WARNING : check_null_df done ...
16-10-2023 11:22:30 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 11:22:30 : validate : WARNING : check_null_df done ...
16-10-2023 11:22:40 : root : INFO : Data transformation
16-10-2023 11:22:40 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:22:40 : data_transformation : WARNING : Count zip
16-10-2023 11:22:40 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:22:43 : data_transformation : WARNING : Data report done...........
16-10-2023 11:22:43 : root : INFO : --------------Application done----------------
16-10-2023 11:23:48 : root : INFO : Calling spark object
16-10-2023 11:23:48 : create_spark : INFO : start get_spark_object method
16-10-2023 11:23:48 : create_spark : INFO : master is local[*]
16-10-2023 11:23:52 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fb3e00c46d0>...
16-10-2023 11:23:52 : root : INFO : Validate spark object
16-10-2023 11:23:52 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:23:56 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:23:56 : validate : WARNING : Validation done ...
16-10-2023 11:23:56 : root : INFO : Load file 
16-10-2023 11:23:56 : ingest : WARNING : Start load file method ======
16-10-2023 11:23:57 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:23:57 : ingest : WARNING : Start load file method ======
16-10-2023 11:24:01 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:24:01 : root : INFO : Validate dataframe
16-10-2023 11:24:01 : ingest : WARNING : Start validate df method =====
16-10-2023 11:24:01 : ingest : WARNING : Number record df: 28338
16-10-2023 11:24:01 : ingest : WARNING : Start validate df method =====
16-10-2023 11:24:02 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:24:02 : root : INFO : Processing dataframe
16-10-2023 11:24:02 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:24:02 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:24:03 : data_processing : WARNING : Create a new column
16-10-2023 11:24:03 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:24:03 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:24:03 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:24:05 : data_processing : WARNING : Clean data done.......
16-10-2023 11:24:05 : root : INFO : Check null after processing
16-10-2023 11:24:05 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 11:24:05 : validate : WARNING : check_null_df done ...
16-10-2023 11:24:06 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 11:24:06 : validate : WARNING : check_null_df done ...
16-10-2023 11:24:17 : root : INFO : Data transformation
16-10-2023 11:24:17 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:24:17 : data_transformation : WARNING : Count zip
16-10-2023 11:24:17 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:24:18 : data_transformation : WARNING : Data report done...........
16-10-2023 11:24:18 : root : INFO : --------------Application done----------------
16-10-2023 11:24:41 : root : INFO : Calling spark object
16-10-2023 11:24:41 : create_spark : INFO : start get_spark_object method
16-10-2023 11:24:41 : create_spark : INFO : master is local[*]
16-10-2023 11:24:45 : root : ERROR : KeyboardInterrupt while sending command.
Traceback (most recent call last):
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/bao/Desktop/data/medicine/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt
16-10-2023 11:24:50 : root : INFO : Calling spark object
16-10-2023 11:24:50 : create_spark : INFO : start get_spark_object method
16-10-2023 11:24:50 : create_spark : INFO : master is local[*]
16-10-2023 11:24:54 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f69bff0b6d0>...
16-10-2023 11:24:54 : root : INFO : Validate spark object
16-10-2023 11:24:54 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:25:00 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:25:00 : validate : WARNING : Validation done ...
16-10-2023 11:25:00 : root : INFO : Load file 
16-10-2023 11:25:00 : ingest : WARNING : Start load file method ======
16-10-2023 11:25:00 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:25:00 : ingest : WARNING : Start load file method ======
16-10-2023 11:25:05 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:25:05 : root : INFO : Validate dataframe
16-10-2023 11:25:05 : ingest : WARNING : Start validate df method =====
16-10-2023 11:25:06 : ingest : WARNING : Number record df: 28338
16-10-2023 11:25:06 : ingest : WARNING : Start validate df method =====
16-10-2023 11:25:07 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:25:07 : root : INFO : Processing dataframe
16-10-2023 11:25:07 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:25:07 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:25:07 : data_processing : WARNING : Create a new column
16-10-2023 11:25:07 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:25:07 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:25:07 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:25:09 : data_processing : WARNING : Clean data done.......
16-10-2023 11:25:09 : root : INFO : Check null after processing
16-10-2023 11:25:09 : validate : WARNING : Start check_null_df method ====(df_city)
16-10-2023 11:25:10 : validate : WARNING : check_null_df done ...
16-10-2023 11:25:11 : validate : WARNING : Start check_null_df method ====(df_pres)
16-10-2023 11:25:11 : validate : WARNING : check_null_df done ...
16-10-2023 11:25:22 : root : INFO : Data transformation
16-10-2023 11:25:22 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:25:22 : data_transformation : WARNING : Count zip
16-10-2023 11:25:22 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:25:27 : data_transformation : WARNING : Data report done...........
16-10-2023 11:25:27 : root : INFO : --------------Application done----------------
16-10-2023 11:26:48 : root : INFO : Calling spark object
16-10-2023 11:26:48 : create_spark : INFO : start get_spark_object method
16-10-2023 11:26:48 : create_spark : INFO : master is local[*]
16-10-2023 11:26:53 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe02580f6d0>...
16-10-2023 11:26:53 : root : INFO : Validate spark object
16-10-2023 11:26:53 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:26:57 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:26:57 : validate : WARNING : Validation done ...
16-10-2023 11:26:57 : root : INFO : Load file 
16-10-2023 11:26:57 : ingest : WARNING : Start load file method ======
16-10-2023 11:26:58 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:26:58 : ingest : WARNING : Start load file method ======
16-10-2023 11:27:01 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:27:01 : root : INFO : Validate dataframe
16-10-2023 11:27:01 : ingest : WARNING : Start validate df method =====
16-10-2023 11:27:02 : ingest : WARNING : Number record df: 28338
16-10-2023 11:27:02 : ingest : WARNING : Start validate df method =====
16-10-2023 11:27:03 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:27:03 : root : INFO : Processing dataframe
16-10-2023 11:27:03 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:27:03 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:27:03 : data_processing : WARNING : Create a new column
16-10-2023 11:27:03 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:27:03 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:27:03 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:27:06 : data_processing : WARNING : Clean data done.......
16-10-2023 11:27:06 : root : INFO : Check null after processing
16-10-2023 11:27:06 : root : INFO : Data transformation
16-10-2023 11:27:06 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:27:06 : data_transformation : WARNING : Count zip
16-10-2023 11:27:06 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:27:09 : data_transformation : WARNING : Data report done...........
16-10-2023 11:27:09 : root : INFO : --------------Application done----------------
16-10-2023 11:31:59 : root : INFO : Calling spark object
16-10-2023 11:31:59 : create_spark : INFO : start get_spark_object method
16-10-2023 11:31:59 : create_spark : INFO : master is local[*]
16-10-2023 11:32:03 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fca67d75070>...
16-10-2023 11:32:03 : root : INFO : Validate spark object
16-10-2023 11:32:03 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:32:07 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:32:07 : validate : WARNING : Validation done ...
16-10-2023 11:32:07 : root : INFO : Load file 
16-10-2023 11:32:07 : ingest : WARNING : Start load file method ======
16-10-2023 11:32:08 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:32:08 : ingest : WARNING : Start load file method ======
16-10-2023 11:32:12 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:32:12 : root : INFO : Validate dataframe
16-10-2023 11:32:12 : ingest : WARNING : Start validate df method =====
16-10-2023 11:32:13 : ingest : WARNING : Number record df: 28338
16-10-2023 11:32:13 : ingest : WARNING : Start validate df method =====
16-10-2023 11:32:14 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:32:14 : root : INFO : Processing dataframe
16-10-2023 11:32:14 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:32:14 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:32:14 : data_processing : WARNING : Create a new column
16-10-2023 11:32:14 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:32:14 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:32:14 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:32:16 : data_processing : WARNING : Clean data done.......
16-10-2023 11:32:16 : root : INFO : Check null after processing
16-10-2023 11:32:16 : root : INFO : Data transformation
16-10-2023 11:32:16 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:32:16 : data_transformation : WARNING : Count zip
16-10-2023 11:32:17 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:32:20 : data_transformation : WARNING : Data report done...........
16-10-2023 11:32:20 : root : INFO : --------------Application done----------------
16-10-2023 11:32:56 : root : INFO : Calling spark object
16-10-2023 11:32:56 : create_spark : INFO : start get_spark_object method
16-10-2023 11:32:56 : create_spark : INFO : master is local[*]
16-10-2023 11:33:01 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f6f57129580>...
16-10-2023 11:33:01 : root : INFO : Validate spark object
16-10-2023 11:33:01 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:33:05 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:33:05 : validate : WARNING : Validation done ...
16-10-2023 11:33:05 : root : INFO : Load file 
16-10-2023 11:33:05 : ingest : WARNING : Start load file method ======
16-10-2023 11:33:06 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:33:06 : ingest : WARNING : Start load file method ======
16-10-2023 11:33:09 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:33:09 : root : INFO : Validate dataframe
16-10-2023 11:33:09 : ingest : WARNING : Start validate df method =====
16-10-2023 11:33:10 : ingest : WARNING : Number record df: 28338
16-10-2023 11:33:10 : ingest : WARNING : Start validate df method =====
16-10-2023 11:33:11 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:33:11 : root : INFO : Processing dataframe
16-10-2023 11:33:11 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:33:11 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:33:11 : data_processing : WARNING : Create a new column
16-10-2023 11:33:11 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:33:11 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:33:11 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:33:14 : data_processing : WARNING : Clean data done.......
16-10-2023 11:33:14 : root : INFO : Check null after processing
16-10-2023 11:33:14 : root : INFO : Data transformation
16-10-2023 11:33:14 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:33:14 : data_transformation : WARNING : Count zip
16-10-2023 11:33:14 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:33:19 : data_transformation : WARNING : Data report done...........
16-10-2023 11:33:19 : root : INFO : --------------Application done----------------
16-10-2023 11:36:02 : root : INFO : Calling spark object
16-10-2023 11:36:02 : create_spark : INFO : start get_spark_object method
16-10-2023 11:36:02 : create_spark : INFO : master is local[*]
16-10-2023 11:36:07 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe193bc4bb0>...
16-10-2023 11:36:07 : root : INFO : Validate spark object
16-10-2023 11:36:07 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:36:13 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:36:13 : validate : WARNING : Validation done ...
16-10-2023 11:36:13 : root : INFO : Load file 
16-10-2023 11:36:13 : ingest : WARNING : Start load file method ======
16-10-2023 11:36:14 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:36:14 : ingest : WARNING : Start load file method ======
16-10-2023 11:36:19 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:36:19 : root : INFO : Validate dataframe
16-10-2023 11:36:19 : ingest : WARNING : Start validate df method =====
16-10-2023 11:36:20 : ingest : WARNING : Number record df: 28338
16-10-2023 11:36:20 : ingest : WARNING : Start validate df method =====
16-10-2023 11:36:21 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:36:21 : root : INFO : Processing dataframe
16-10-2023 11:36:21 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:36:21 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:36:21 : data_processing : WARNING : Create a new column
16-10-2023 11:36:21 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:36:21 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:36:21 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:36:24 : data_processing : WARNING : Clean data done.......
16-10-2023 11:36:24 : root : INFO : Check null after processing
16-10-2023 11:36:24 : root : INFO : Data transformation
16-10-2023 11:36:24 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:36:24 : data_transformation : WARNING : Count zip
16-10-2023 11:36:24 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:36:24 : data_transformation : ERROR : An error occurs in data_report1 None
16-10-2023 11:36:24 : root : ERROR : An error in main() : [AMBIGUOUS_REFERENCE] Reference `city` is ambiguous, could be: [`city`, `city`].
16-10-2023 11:36:24 : root : INFO : --------------Application done----------------
16-10-2023 11:42:25 : root : INFO : Calling spark object
16-10-2023 11:42:25 : create_spark : INFO : start get_spark_object method
16-10-2023 11:42:25 : create_spark : INFO : master is local[*]
16-10-2023 11:42:29 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f20e192dbb0>...
16-10-2023 11:42:29 : root : INFO : Validate spark object
16-10-2023 11:42:29 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:42:33 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:42:33 : validate : WARNING : Validation done ...
16-10-2023 11:42:33 : root : INFO : Load file 
16-10-2023 11:42:33 : ingest : WARNING : Start load file method ======
16-10-2023 11:42:34 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:42:34 : ingest : WARNING : Start load file method ======
16-10-2023 11:42:38 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:42:38 : root : INFO : Validate dataframe
16-10-2023 11:42:38 : ingest : WARNING : Start validate df method =====
16-10-2023 11:42:38 : ingest : WARNING : Number record df: 28338
16-10-2023 11:42:38 : ingest : WARNING : Start validate df method =====
16-10-2023 11:42:39 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:42:39 : root : INFO : Processing dataframe
16-10-2023 11:42:39 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:42:39 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:42:39 : data_processing : WARNING : Create a new column
16-10-2023 11:42:39 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:42:39 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:42:39 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:42:41 : data_processing : WARNING : Clean data done.......
16-10-2023 11:42:41 : root : INFO : Check null after processing
16-10-2023 11:42:41 : root : INFO : Data transformation
16-10-2023 11:42:41 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:42:41 : data_transformation : WARNING : Count zip
16-10-2023 11:42:41 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:42:42 : data_transformation : ERROR : An error occurs in data_report1 None
16-10-2023 11:42:42 : root : ERROR : An error in main() : [AMBIGUOUS_REFERENCE] Reference `city` is ambiguous, could be: [`city`, `city`].
16-10-2023 11:42:42 : root : INFO : --------------Application done----------------
16-10-2023 11:43:31 : root : INFO : Calling spark object
16-10-2023 11:43:31 : create_spark : INFO : start get_spark_object method
16-10-2023 11:43:31 : create_spark : INFO : master is local[*]
16-10-2023 11:43:35 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fe2dad6e580>...
16-10-2023 11:43:35 : root : INFO : Validate spark object
16-10-2023 11:43:35 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:43:39 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:43:39 : validate : WARNING : Validation done ...
16-10-2023 11:43:39 : root : INFO : Load file 
16-10-2023 11:43:39 : ingest : WARNING : Start load file method ======
16-10-2023 11:43:39 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:43:39 : ingest : WARNING : Start load file method ======
16-10-2023 11:43:44 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:43:44 : root : INFO : Validate dataframe
16-10-2023 11:43:44 : ingest : WARNING : Start validate df method =====
16-10-2023 11:43:44 : ingest : WARNING : Number record df: 28338
16-10-2023 11:43:44 : ingest : WARNING : Start validate df method =====
16-10-2023 11:43:46 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:43:46 : root : INFO : Processing dataframe
16-10-2023 11:43:46 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:43:46 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:43:46 : data_processing : WARNING : Create a new column
16-10-2023 11:43:46 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:43:46 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:43:46 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:43:48 : data_processing : WARNING : Clean data done.......
16-10-2023 11:43:48 : root : INFO : Check null after processing
16-10-2023 11:43:48 : root : INFO : Data transformation
16-10-2023 11:43:48 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:43:48 : data_transformation : WARNING : Count zip
16-10-2023 11:43:48 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:43:48 : data_transformation : ERROR : An error occurs in data_report1 None
16-10-2023 11:43:48 : root : ERROR : An error in main() : name 'df_city_agg' is not defined
16-10-2023 11:43:48 : root : INFO : --------------Application done----------------
16-10-2023 11:43:59 : root : INFO : Calling spark object
16-10-2023 11:43:59 : create_spark : INFO : start get_spark_object method
16-10-2023 11:43:59 : create_spark : INFO : master is local[*]
16-10-2023 11:44:03 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f6bb221fbb0>...
16-10-2023 11:44:03 : root : INFO : Validate spark object
16-10-2023 11:44:03 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:44:08 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:44:08 : validate : WARNING : Validation done ...
16-10-2023 11:44:08 : root : INFO : Load file 
16-10-2023 11:44:08 : ingest : WARNING : Start load file method ======
16-10-2023 11:44:09 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:44:09 : ingest : WARNING : Start load file method ======
16-10-2023 11:44:14 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:44:14 : root : INFO : Validate dataframe
16-10-2023 11:44:14 : ingest : WARNING : Start validate df method =====
16-10-2023 11:44:15 : ingest : WARNING : Number record df: 28338
16-10-2023 11:44:15 : ingest : WARNING : Start validate df method =====
16-10-2023 11:44:16 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:44:16 : root : INFO : Processing dataframe
16-10-2023 11:44:16 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:44:16 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:44:16 : data_processing : WARNING : Create a new column
16-10-2023 11:44:16 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:44:16 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:44:16 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:44:19 : data_processing : WARNING : Clean data done.......
16-10-2023 11:44:19 : root : INFO : Check null after processing
16-10-2023 11:44:19 : root : INFO : Data transformation
16-10-2023 11:44:19 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:44:19 : data_transformation : WARNING : Count zip
16-10-2023 11:44:19 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:44:23 : data_transformation : WARNING : Data report done...........
16-10-2023 11:44:23 : root : INFO : --------------Application done----------------
16-10-2023 11:44:28 : root : INFO : Calling spark object
16-10-2023 11:44:28 : create_spark : INFO : start get_spark_object method
16-10-2023 11:44:28 : create_spark : INFO : master is local[*]
16-10-2023 11:44:32 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7fc5bbc17bb0>...
16-10-2023 11:44:32 : root : INFO : Validate spark object
16-10-2023 11:44:32 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:44:36 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:44:36 : validate : WARNING : Validation done ...
16-10-2023 11:44:36 : root : INFO : Load file 
16-10-2023 11:44:36 : ingest : WARNING : Start load file method ======
16-10-2023 11:44:37 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:44:37 : ingest : WARNING : Start load file method ======
16-10-2023 11:44:41 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:44:41 : root : INFO : Validate dataframe
16-10-2023 11:44:41 : ingest : WARNING : Start validate df method =====
16-10-2023 11:44:41 : ingest : WARNING : Number record df: 28338
16-10-2023 11:44:41 : ingest : WARNING : Start validate df method =====
16-10-2023 11:44:43 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:44:43 : root : INFO : Processing dataframe
16-10-2023 11:44:43 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:44:43 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:44:43 : data_processing : WARNING : Create a new column
16-10-2023 11:44:43 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:44:43 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:44:43 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:44:45 : data_processing : WARNING : Clean data done.......
16-10-2023 11:44:45 : root : INFO : Check null after processing
16-10-2023 11:44:45 : root : INFO : Data transformation
16-10-2023 11:44:45 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:44:45 : data_transformation : WARNING : Count zip
16-10-2023 11:44:45 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:44:50 : data_transformation : WARNING : Data report done...........
16-10-2023 11:44:50 : root : INFO : --------------Application done----------------
16-10-2023 11:45:31 : root : INFO : Calling spark object
16-10-2023 11:45:31 : create_spark : INFO : start get_spark_object method
16-10-2023 11:45:31 : create_spark : INFO : master is local[*]
16-10-2023 11:45:35 : create_spark : INFO : Spark obect created :<pyspark.sql.session.SparkSession object at 0x7f3d8d9a7bb0>...
16-10-2023 11:45:35 : root : INFO : Validate spark object
16-10-2023 11:45:35 : validate : WARNING : Start get_current_date method=====
16-10-2023 11:45:39 : validate : WARNING : Validate spark object with current date :2023-10-16
16-10-2023 11:45:39 : validate : WARNING : Validation done ...
16-10-2023 11:45:39 : root : INFO : Load file 
16-10-2023 11:45:39 : ingest : WARNING : Start load file method ======
16-10-2023 11:45:40 : ingest : WARNING : Load file done which is of parquet..........
16-10-2023 11:45:40 : ingest : WARNING : Start load file method ======
16-10-2023 11:45:44 : ingest : WARNING : Load file done which is of csv..........
16-10-2023 11:45:44 : root : INFO : Validate dataframe
16-10-2023 11:45:44 : ingest : WARNING : Start validate df method =====
16-10-2023 11:45:45 : ingest : WARNING : Number record df: 28338
16-10-2023 11:45:45 : ingest : WARNING : Start validate df method =====
16-10-2023 11:45:46 : ingest : WARNING : Number record df: 1329329
16-10-2023 11:45:46 : root : INFO : Processing dataframe
16-10-2023 11:45:46 : data_processing : WARNING : Start clean data method ====
16-10-2023 11:45:46 : data_processing : WARNING : Selecting a few columns and rename
16-10-2023 11:45:46 : data_processing : WARNING : Create a new column
16-10-2023 11:45:46 : data_processing : WARNING : Convert "years_of_exp" from string to int
16-10-2023 11:45:46 : data_processing : WARNING : Create full name column with concating columns and drop column
16-10-2023 11:45:46 : data_processing : WARNING : Drop null and replace value
16-10-2023 11:45:48 : data_processing : WARNING : Clean data done.......
16-10-2023 11:45:48 : root : INFO : Check null after processing
16-10-2023 11:45:48 : root : INFO : Data transformation
16-10-2023 11:45:48 : data_transformation : WARNING : Start data_report1 method =====
16-10-2023 11:45:48 : data_transformation : WARNING : Count zip
16-10-2023 11:45:48 : data_transformation : WARNING : Count prescriber id and sum total claim by city
16-10-2023 11:45:48 : data_transformation : WARNING : Data report done...........
16-10-2023 11:45:53 : root : INFO : --------------Application done----------------
